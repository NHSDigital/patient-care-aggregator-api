openapi: 3.0.3
info:
  title: Wayfinder Patient Care Aggregator API
  version: v2.0.4
  description: |
    <div class="nhsd-m-emphasis-box nhsd-m-emphasis-box--emphasis nhsd-!t-margin-bottom-6" aria-label="Highlighted Information">
        <div class="nhsd-a-box nhsd-a-box--border-blue">
            <div class="nhsd-m-emphasis-box__image-box">
                <figure class="nhsd-a-image">
                    <picture class="nhsd-a-image__picture">
                        <img src="http://digital.nhs.uk/binaries/content/gallery/icons/info.svg?colour=231f20" alt="" style="object-fit:fill">
                    </picture>
                </figure>
            </div>
            <div class="nhsd-m-emphasis-box__content-box">
                <div data-uipath="website.contentblock.emphasis.content" class="nhsd-t-word-break"><p class="nhsd-t-body">This API is <a href="https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#statuses">in production, beta but internal</a>, meaning the API is not currently available for integration by external third parties. If you want to use it, <a href="https://digital.nhs.uk/developer/help-and-support">contact us</a> and we'll look at making it available.</p></div>
            </div>
        </div>
    </div>
    
    ## Overview
    
    ![Patient Care Aggregator FHIR API context diagram](https://digital.nhs.uk/binaries/content/gallery/website/developer/api-catalogue/patient-care-aggregator-fhir-api/patient-care-aggregator-api-context-diagram.svg?raw=true)
    
    Use this API to get an aggregated list of referrals and bookings for a patient from secondary care providers.
    
    The API aggregates details of referrals and bookings from a number of systems. For details, see [status and roadmap](https://digital.nhs.uk/developer/guides-and-documentation/building-healthcare-software/referrals-and-bookings/patient-care-aggregator#status-and-roadmap).
    
    We might add other providers in the future.
    
    This API is only for use in patient-facing applications, not point-of-care applications.
    
    For more details, see [Patient access to referrals and bookings via the Patient Care Aggregator](https://digital.nhs.uk/developer/guides-and-documentation/building-healthcare-software/referrals-and-bookings/patient-care-aggregator).
    
    ## Who can use this API
    Currently, this API is for internal use only - the only API consumer is the NHS App.
    
    If you are interested in using this API in another context, [contact us](https://digital.nhs.uk/developer/help-and-support).
    
    ## API status
    This API is [in production, beta but internal](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#statuses), meaning the API is not currently available for integration by external third parties. If you want to use it, [contact us](https://digital.nhs.uk/developer/help-and-support) and we'll look at making it available.
        
    If you would still like to be involved in our beta programme or use this API, [contact us](https://digital.nhs.uk/developer/help-and-support).
        
    ## Service level
    This API is a silver service, meaning it is operational 24 hours a day, 365 days a year but only supported during working hours.
    
    For more details, see [service levels](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#service-levels).
    
    ## Technology
    This API is [RESTful](https://digital.nhs.uk/developer/guides-and-documentation/api-technologies-at-nhs-digital#basic-rest).
    
    It conforms to the [FHIR](https://digital.nhs.uk/developer/guides-and-documentation/api-technologies-at-nhs-digital#fhir)
    global standard for health care data exchange, specifically to [FHIR R4 (v4.0.1)](https://hl7.org/fhir/r4/),
    except that it does not support the [capabilities](http://hl7.org/fhir/R4/http.html#capabilities) interaction.
    
    It includes some country-specific FHIR extensions, which have been built against [FHIR UK Core](https://digital.nhs.uk/services/fhir-uk-core).
    
    You do not need to know much about FHIR to use this API - FHIR APIs are just RESTful APIs that follow specific rules.
    In particular:
    - resource names are capitalised and singular, for example `/CarePlan` not `/care-plans`
    - array names are singular, for example `entry` not `entries` for FHIR bundle entries
    - data items that are country-specific and thus not included in the FHIR global base resources are usually wrapped in an `extension` object
    
    There are [libraries and SDKs available](https://digital.nhs.uk/developer/guides-and-documentation/api-technologies-at-nhs-digital#fhir-libraries-and-sdks) to help with FHIR API integration.

    You must adhere to the following requirements when integrating to the Wayfinder Patient Care Aggregator.

    | Requirement Reference | Quality attribute(s)                                 | Requirement                           | MoSCoW  |
    |-----------------------|------------------------------------------------------|---------------------------------------|---------|
    | WF-NFR-01             | Performance                                          | **Response times**<br>API requests for appointments and referrals must return a response with patient data within 1,000ms at 95th percentile (P95).<br>API requests for wait times must return a response within 600ms at 95th percentile (P95)                        | M/S     |
    | WF-NFR-02             | Performance                                          | **Timeouts**<br>The API must respond with a HTTP 504 'Gateway Timeout' after 10,000 ms have expired<br>*Note* that calls to ODS and e-RS  Healthcare Services APIs time out after 30,000 ms                              | M       |
    | WF-NFR-03             | Availability                                         | **Throttling**<br>The API must limit requests and respond with a HTTP 429 'Too Many Requests' response at 25 TPS (transactions per second)<br>*Note* the 25 TPS rate limit applies to each API that the Patient Care Aggregator provides for the NHS App, including the API for the retrieval of appointment and referrals, as well as the API to retrieve wait times.                            | M       |
    | WF-NFR-04             | Reliability                                          | **Data timeliness**<br>N/A                       | M       |
    | WF-NFR-05             | Availability                                         | **Service availability**<br>The Aggregator will provide Silver+ (99.5%) availability under NHS guidelines<br>See [Cloud security - good practice guide](https://digital.nhs.uk/services/cloud-centre-of-excellence/cloud-security-good-practice-guide/9.-appendix-b-service-classifications)                  | M       |
    | WF-NFR-06             | Availability<br>Reliability<br>Evolvability          | **Releases & Maintenance**<br>Sprint cadence of 2 weeks with at least one release by the end of each sprint<br>During maintenace windows (max 2hrs) API must respond with HTTP 503 Service Unavailable                | M       |
    | WF-NFR-07             | Usability                                            | **No content for user**<br>Respond with HTTP 200 'OK' status code with an empty body if no data was retrieved and there were no upstream errors.<br>This applies to all APIs published by the Patient Care Aggregator.<br>See below for partial response errors.                   | M       |
    | WF-NFR-08             | Usability                                            | **Partial response**<br>API to return HTTP 207 'Multiple Responses' highlighting where data has been successfully returned from upstream APIs and where it has not.Â                       | M       |
    | WF-NFR-09             | Observability<br>Security<br>Information governance  | **Logging and alerting**<br>All logs must be shipped into NHSE's preferred logging tools and/or dashboards.<br>All requests must be clearly tracable.<br>Errors must generate alarms against NHSE agreed thresholds.<br>Alarms must not be raised for errors against maintenance responses.<br>Clinical and personal identifiable data must be omitted from production logs.<br>`X-Correlation-ID` must be propagated to e-RS and all Portal systems, and all transactional log events that contain X-Correlation-ID must be retained for 90 days.                  | M       |
    | WF-NFR-10             | Testability                                          | **Contract testing**<br>A range of contract tests for all integrated parties against the full range of API requests must be included in the build pipeline job for any Aggregator changes.                      | M       |
    | WF-NFR-11             | Performance                                          | **Volumetrics**<br>Close tracking of the following is required for BETA period:<br>- Transactions per second<br>- Requests to Aggregator (unique/returning)<br>- Requests to e-RS (unique/returning)<br>- Requests to Portal (unique/returning)<br>- Errors (by type)                           | M       |
    | WF-NFR-12             | Cost<br>Security<br>Interoperability                 | **Hosting**<br>The Aggregator must be hosted on NHS Digital's Cloud.<br>Access to all its APIs must be controlled via the NHSE's API Platform (https://digital.nhs.uk/services/api-platform)                               | M       |
    | WF-NFR-13             | Serviceability                                       | **Operations**<br>Commitment of operational response against Silver+ (99.5%) availability under NHS guidelines.<br>See [Cloud security - good practice guide](https://digital.nhs.uk/services/cloud-centre-of-excellence/cloud-security-good-practice-guide/9.-appendix-b-service-classifications)<br>This will require on-call DevOps escalation for outages                            | M       |
    | WF-NFR-14             | Security                                             | **Authentication**<br>**Patient authentication**<br>- The Aggregator must expose all its public endpoints via the NHSE's API Platform (https://digital.nhs.uk/services/api-platform) and utilise the NHS login's ID token for authentication of patients.<br>- The NHS login' ID token provided in requests from the NHS App will be passed to all downstream calls to NHS e-RS and the Portal system.<br>- Checking of NHS login's identity proofing level (e.g. P9) will not be carried out in the Aggregator.<br><br>**System authentication**<br>- Calls to Portal systems' APIs must utilise OAuth 2.0 Client Credentials Flow pattern.                        | M       |
    | WF-NFR-15             | Information governance                               | **User data revocation or request**<br>N/A       | M       |
    | WF-NFR-16             | Information governance<br>Clinical safety            | **Age restriction**<br>Any request from a patient younger than 16 years of age must be responded to with HTTP 403 'Forbidden' status code with clear indication that the patient is under the minimum age limit.                       | M       |
    | WF-NFR-17             | Security<br>Information governance                   | **Access to personal identifiable data**<br>All user requests to the Aggregator must be logged and audited. Personal identifiable data must not be recorded in production or any other logs<br>Any access to personal identifiable data in the Aggregator must be limited to the security cleared staff.<br>Access to AWS services that hold personal identifiable data must be managed by NHSE and its security controls  | M       |
    | WF-NFR-18             | Security<br>Clinical safety                          | **Inactivity timeouts**<br>N/A                   | M       |

    ## Network access
    This API is available on the internet and, indirectly, on the [Health and Social Care Network (HSCN)](https://digital.nhs.uk/services/health-and-social-care-network).
    
    For more details see [Network access for APIs](https://digital.nhs.uk/developer/guides-and-documentation/network-access-for-apis).
    
    ## Security and authorisation
    This API is [user-restricted](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#user-restricted-apis), meaning an end user must be present, authenticated and authorised.
    
    The end user must be:
    * a patient who receives health and social care or makes use of NHS services
    * strongly authenticated, using [NHS login](https://digital.nhs.uk/services/nhs-login)
    
    To use this API, use one of the following security patterns:
    
    |Security pattern                                                                                                                                                                                                               |Technical details                                    |Advantages                                                   | Disadvantages                                           |
    |-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ----------------------------------------------------| ------------------------------------------------------------|---------------------------------------------------------|
    |[NHS login - combined authentication and authorisation](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/user-restricted-restful-apis-nhs-login-combined-authentication-and-authorisation) |OAuth 2.0 authorisation code with API key and secret |No need to integrate and onboard separately with NHS login.  |No access to user information.                           |
    |[NHS login - separate authentication and authorisation](https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation/user-restricted-restful-apis-nhs-login-separate-authentication-and-authorisation) |OAuth 2.0 token exchange with signed JWT             |Gives access to user information.                            |Need to integrate and onboard separately with NHS login. |
    
    ## Environments and testing
    | Environment       | Base URL                                                                        | Linked NHS login environment  |
    | ----------------- | ------------------------------------------------------------------------------- | ----------------------------- |
    | Sandbox           | Not available                                                                   | Not applicable                |
    | Integration test  | `https://int.api.service.nhs.uk/patient-care-aggregator-api/aggregator/events/` | NHS login - integration (AOS) |
    | Production        | `https://api.service.nhs.uk/patient-care-aggregator-api/aggregator/events/`     | NHS login - Live (production) |
    
    ### Sandbox testing
    This API does not currently have a sandbox environment. If you would like us to add one, [contact us](https://digital.nhs.uk/developer/help-and-support).
    
    ### Integration testing
    Our [integration test environment](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing):
    * is for formal integration testing
    * includes authorisation
    
    It is an end-to-end environment - it includes instances of each of the upstream applications, and is linked to the Integration (AOS) instance of NHS login.
    
    For details of test data, see [Patient care aggregator test data packs](https://digital.nhs.uk/developer/api-catalogue/patient-care-aggregator-fhir/patient-care-aggregator-fhir-api-test-data).
    
    For more details on integration testing, see [integration testing with our RESTful APIs](https://digital.nhs.uk/developer/guides-and-documentation/testing#integration-testing-with-our-restful-apis).
    
    ## Onboarding
    You need to get your software approved by us before it can go live with this API. We call this onboarding. The onboarding process can sometimes be quite long, so itâs worth planning well ahead.
    
    To onboard for this API, follow the [Supplier Conformance Assessment List (SCAL)](https://digital.nhs.uk/developer/guides-and-documentation/onboarding-process#onboard-using-the-supplier-conformance-assessment-list-scal-process) process.
    
    To get started with the SCAL process for this API, [contact us](https://digital.nhs.uk/developer/help-and-support).
    
    ## Errors
    We use standard HTTP status codes to show whether an API request succeeded or not. They are usually in the range:
    
    * 200 to 299 if it succeeded, including code 202 if it was accepted by an API that needs to wait for further action
    * 400 to 499 if it failed because of a client error by your application
    * 500 to 599 if it failed because of an error on our server
    
    Errors specific to each API are shown in the Endpoints section, under Response. See our [reference guide](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#http-status-codes) for more on errors.
  contact:
    name: patient-care-aggregator-api API Support
    url: https://digital.nhs.uk/developer/help-and-support
    email: api.management@nhs.net
servers:
  - url: https://sandbox.api.service.nhs.uk/patient-care-aggregator-api
    description: Sandbox environment
  - url: https://int.api.service.nhs.uk/patient-care-aggregator-api
    description: Integration environment (AOS)
  - url: https://api.service.nhs.uk/patient-care-aggregator-api
    description: Production environment
paths:
  /aggregator/events:
    get:
      summary: Get patients referrals, bookings, documents, questionnaires and waiting lists
      operationId: get-referrals-and-bookings
      description: The Wayfinder Patient Care Aggregator CarePlan response will return a FHIR [Bundle](https://www.hl7.org/fhir/r4/bundle.html) resource which will contain one [CarePlan](https://www.hl7.org/fhir/r4/careplan.html) resource per Waiting List Entry, one [CarePlan](https://www.hl7.org/fhir/r4/careplan.html) resource containing all Referrals, Appointments, Documents and Questionnaires and one optional [OperationOutcome](https://www.hl7.org/fhir/r4/OperationOutcome.html) resource (based on the UK Core FHIR specification) for use by the NHS App to the following specification.
        
        #Use this endpoint to get an aggregated list of referrals and bookings for a patient from secondary care providers.
        #The endpoint checks for referrals and bookings from multiple upstream applications and aggregates them into a single list.

        #The endpoint returns the list as a FHIR 'bundle' which includes:
        #- one `CarePlan` resource, including all referrals and bookings found for the patient, but only if any referrals or bookings were found
        #- one `OperationOutcome` resource, if any of the upstream applications returned an error

        #If no referrals or bookings were found for the patient, and there were no errors, the endpoint returns an empty FHIR bundle.
      tags:
        - Patient Care Aggregator
      parameters:
        - $ref: "#/components/parameters/nhsNumber"
        # - $ref: "#/components/parameters/xRequestId"
        - $ref: "#/components/parameters/xCorrelationId"
        - $ref: "#/components/parameters/nhsdIdToken"
        # - $ref: "#/components/parameters/nhsdTargetIdentifier"
      responses:
        2XX:
          $ref: "#/components/responses/2XX"
        4XX:
          $ref: "#/components/responses/4XX"
        5XX:
          $ref: "#/components/responses/5XX"
components:
  schemas:
    Bundle:
      description: A FHIR `Bundle` resource containing the search results of the request.
      type: object
      required:
        - resourceType
        - type
      properties:
        resourceType:
          description: FHIR resource type.
          type: string
          enum:
            - Bundle
        id:
          description: The X-Correlation-ID from the Request header
          type: string
          example:
            $ref: "#/components/parameters/xCorrelationId/schema/example"
        meta:
          description: Metadata about the resource
          type: object
          properties:
            profile:
              description: Profiles this resource claims to conform to
              type: array
              items:
                description: Wayfinder UK Core `Bundle` `StructureDefinition`
                type: string
                enum:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type:
          description: The type of FHIR bundle.
          type: string
          enum:
            - searchset
        total:
          description: The total number of matches
          type: number
          example: 1
        entry:
          description: |
            The FHIR resources within the bundle.
            Includes `0..*` `CarePlan` resources (containing referral, booking, document and questionnaire information, if any found) and `0..1` `OperationOutcome` resources (if any upstream system errors occurred).
          type: array
          minItems: 0
          items:
            anyOf:
              - description: Details of the referrals and bookings found for the patient, expressed as a FHIR `CarePlan` resource.
                type: object
                required:
                  - fullUrl
                  - resource
                  - search
                properties:
                  fullUrl:
                    description: URI for the `CarePlan` resource.
                    type: string
                    example: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/c93e2449-a2ef-4476-ad15-13491036be22
                    #example: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/RTD~ABC220939220X
                  search:
                    description: Search-related information for the `CarePlan` resource.
                    type: object
                    required:
                      - mode
                    properties:
                      mode:
                        description: Indicates why this resource is in the result set - in this case because it includes infomation that matched the requested patient.
                        type: string
                        enum:
                          - match
                  resource:
                    $ref: "#/components/schemas/CarePlan"
              - description: Details of any errors returnd by upstream applications, expressed as a FHIR `OperationOutcome` resource.
                type: object
                required:
                  - fullUrl
                  - resource
                  - search
                properties:
                  fullUrl:
                    description: URI for the `OperationOutcome` resource.
                    type: string
                    example: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/c93e2449-a2ef-4476-ad15-13491036be22
                  search:
                    description: Search-related information for the `OperationOutcome` resource.
                    type: object
                    required:
                      - mode
                    properties:
                      mode:
                        description: Indicates why this resource is in the result set.
                        type: string
                        enum:
                          - include
                  resource:
                    $ref: "#/components/schemas/OperationOutcome"
      externalDocs:
        description: FHIR UK Core Bundle (R4) Resource Profile
        url: https://hl7.org/fhir/R4/bundle.html
    CarePlan:
      description: A FHIR `CarePlan` resource _describes the intention of how one or more clinicians intend to deliver care for a particular patient for a period of time, for a specific condition_.
        This represents a pathway of care and contains a summary of Referrals, Appointments, Documents and Questionnaires.
      type: object
      required:
        - resourceType
        - status
        - intent
        - subject
      properties:
        resourceType:
          description: FHIR resource type.
          type: string
          enum:
            - CarePlan
        meta:
          description: Metadata about the resource
          type: object
          properties:
            lastUpdated:
              description: The census date for when the pathway of care waiting list was last submitted by the responsible provider i.e. last confirmed as correct.  This is mandatory for Waiting List (CarePlans).
              type: string
              example: '2023-06-25T00:00:00+00:00'
            profile:
              description: Profiles this resource claims to conform to
              type: array
              items:
                description: Wayfinder UK Core `CarePlan` `StructureDefinition`
                type: string
                enum:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
        identifier:
          description: Identifier for the pathway of care
          type: array
          items:
            description: Pathway of care Identifier
            type: object
            properties:
              system:
                description: Type of identifier.
                type: string
                enum:
                  - https://fhir.nhs.uk/Id/care-pathway-id
              value:
                description: The pathway of care identifier itself.
                type: string
                example: RTD~ABC220939220X
        status:
          description: Status of the care plan.
          type: string
          enum:
            - active
            - completed
        intent:
          description: Level of authority / intentionality associated with the care plan and where the care plan fits into the workflow chain.
          type: string
          enum:
            - order
        title:
          description: Specialty referred to for the pathway of care.
          type: string
          example: Ophthalmology
        subject:
          description: Patient or group whose intended care is described by the plan.
          type: object
          required:
            - identifier
          properties:
            identifier:
              description: Unique identifier for the patient - specifically, their NHS number.
              type: object
              required:
                - system
                - value
              properties:
                system:
                  description: Type of identifier.
                  type: string
                  enum:
                    - https://fhir.nhs.uk/Id/nhs-number
                value:
                  description: The NHS number itself.
                  type: string
                  example: '9000000009'
        period:
          description: Time period the pathway of care covers
          type: object
          properties:
            start:
              description: The start date of the pathway of care, typically the referral recevied date.
              type: string
              example: 2022-06-22
            end:
              description: The end date of the pathway of care, typically the treatment or discharged date.
              type: string
              example: 2023-10-03
            extension:
              description: FHIR extension wrapper.
              type: array
              items:
                description: Pathway of care Identifier
                type: object
                properties:
                  url:
                    description: FHIR extension type for the planned wait time.
                    type: string
                    example: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                  valueDuration:
                    description: The planned wait time itself.
                    type: object
                    properties:
                      value:
                        description: The planned wait time value.
                        type: string
                        example: 22
                      unit:
                        description: The planned wait time unit.
                        type: number
                        example: weeks
        author:
          description: The organisation responsible for the pathway of care. This is mandatory for Waiting List (CarePlans).
          type: object
          properties:
            type:
              description: Type of entity.
              type: string
              enum:
                - Organization
            display:
              description: ODS Organisation name (NHS Trust)
              type: string
              example: Isle of Wight NHS TrusT
        activity:
          description: Array of referral, appointments, documents and questionnaires related to the patients care.
          type: array
          items:
            anyOf:
              - $ref: "#/components/schemas/Referral"
              - $ref: "#/components/schemas/Appointment"
              - $ref: "#/components/schemas/Document"
              - $ref: "#/components/schemas/Questionnaire"
      externalDocs:
        description: FHIR UK Core CarePlan (R4) Resource Profile
        url: https://hl7.org/fhir/R4/careplan.html
    Referral:
      description: A summary of the referral for the patient.
      type: object
      required:
        - detail
      properties:
        detail:
          description: Details of the referral.
          type: object
          required:
            - kind
            - status
          properties:
            id:
              description: Unique identifier for the e-RS referral - specifically an e-RS Unique Booking Reference Number (UBRN).
              type: string
              example: '808993698030'
            kind:
              description: Type of activity - referral (`ServiceRequest`).
              type: string
              enum:
                - ServiceRequest
            status:
              description: The status of the activity
              type: string
              enum:
                - in-progress
            extension:
              description: FHIR extension for various additional attributes
              type: array
              items:
                anyOf:
                  - description: URL for a patient-facing web application for the referral or booking. Always present.
                    type: object
                    required:
                      - url
                      - valueUrl
                      - extension
                    properties:
                      url:
                        description: FHIR extension type.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
                      valueUrl:
                        description: The URL itself.
                        type: string
                        example: https://refer.nhs.uk/nhslogin?ubrn=808993698030
                  - description: FHIR extension wrapper for the details of which upstream application the referral or booking came from.
                    type: array
                    items:
                      description: Unique identifier for the upstream application the referral or booking came from.
                      type: object
                      required:
                        - url
                        - valueCode
                      properties:
                        url:
                          description: FHIR extension type for the identifier.
                          type: string
                          enum:
                            - client-id
                        valueCode:
                          description: The identifier itself.
                          type: string
                          example: ers-01
                  - description: Status of the activity, if it is an e-RS referral. Always present for an e-RS referral.
                    type: object
                    required:
                      - url
                      - valueCoding
                    properties:
                      url:
                        description: FHIR extension type for the e-RS referral status.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
                      valueCoding:
                        description: Wrapper for the e-RS referral status.
                        type: object
                        required:
                          - system
                          - code
                        properties:
                          system:
                            description: Code system used for the e-RS referral status.
                            type: string
                            enum:
                              - https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                          code:
                            description: The e-RS request status itself.
                            type: string
                            enum:
                              - bookable
                              - bookableWasCancelled
                              - inReview
                  - description: The specialty of the service to which the referral or booking applies. Always present for a booking; only present for a referral if the referral has been booked.
                    type: object
                    required:
                      - url
                      - valueCoding
                    properties:
                      url:
                        description: FHIR extension type for the specialty.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Specialty
                      valueCoding:
                        description: Wrapper for the specialty.
                        type: object
                        required:
                          - system
                          - display
                        properties:
                          system:
                            description: Code system used for the specialty.
                            type: string
                            enum:
                              - https://fhir.nhs.uk/STU3/CodeSystem/Specialty-1
                          display:
                            description: The specialty itself, in plain text.
                            type: string
                            example: TRAUMA & ORTHOPAEDICS
            description:
              description: The referral service or specialty. The value specialty 2WW is supresses.
              type: string
              example: Rheumatology - Metabolic Bone (inc Complex and Non-Complex cases) - Freeman - Newcastle FT - RTD
            scheduledPeriod:
              description: The period over which the activity is to occur.
              type: object
              required:
                - start
              properties:
                start:
                  description: The Referral date.
                  type: string
                  example: '2023-05-23T10:02:15.960Z'
                extension:
                  description: FHIR extension wrapper for various properties of the scheduled period, if there are any.
                  type: array
                  items:
                    anyOf:
                      - description: The date on which the activity is to be reviewed, if it is a referral. Not always present.
                        type: object
                        required:
                          - url
                          - valueDate
                        properties:
                          url:
                            description: FHIR extension identifier.
                            type: string
                            enum:
                              - https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ReviewDueDate
                          valueDate:
                            description: The date the clinical review is due.
                            type: string
                            example: '2020-11-19'
            performer:
              description: The organisation responsible for the Referral. 
              type: array
              minItems: 1
              maxItems: 1
              items:
                description: The organisation the referral is to.
                type: object
                required:
                  - type
                  - display
                properties:
                  type:
                    description: Type of entity.
                    type: string
                    enum:
                      - Organization
                  display:
                    description: ODS Organisation name (NHS Trust)
                    type: string
                    example: THE NEWCASTLE UPON TYNE HOSPITALS NHS FOUNDATION TRUST
    Appointment:
      description: A summary of the booking for the patient.
      type: object
      required:
        - detail
      properties:
        detail:
          description: Details of the booking.
          type: object
          required:
            - kind
            - status
            - description
            - location
          properties:
            id:
              description: Identifier for the Appointment
              type: string
              example: f9e50676-c9bc-45df-9dd1-1be0fdc3333c
            kind:
              description: Type of activity - booking (`Appointment`).
              type: string
              enum:
                - Appointment
            status:
              description: The status of the Appointment
              type: string
              enum:
                - in-progress
            extension:
              description: FHIR extension wrapper for various country-specific data items.
              type: array
              items:
                anyOf:
                  - description: URL for a patient-facing web application for the referral or booking. Always present.
                    type: object
                    required:
                      - url
                      - valueUrl
                      - extension
                    properties:
                      url:
                        description: FHIR extension type.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
                      valueUrl:
                        description: The URL itself.
                        type: string
                        example: https://refer.nhs.uk/nhslogin?ubrn=808993698030
                  - description: FHIR extension wrapper for the details of which upstream application the referral or booking came from.
                    type: array
                    items:
                      description: Unique identifier for the upstream application the referral or booking came from.
                      type: object
                      required:
                        - url
                        - valueCode
                      properties:
                        url:
                          description: FHIR extension type for the identifier.
                          type: string
                          enum:
                            - client-id
                        valueCode:
                          description: The identifier itself.
                          type: string
                          example: ers-01
                  - description: Status of the activity, if it is a booking. Always present for a booking.
                    type: object
                    required:
                      - url
                      - valueCoding
                    properties:
                      url:
                        description: FHIR extension type for the booking status.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
                      valueCoding:
                        description: Wrapper for the booking status.
                        type: object
                        required:
                          - system
                          - code
                        properties:
                          system:
                            description: Code system used for the booking status.
                            type: string
                            enum:
                              - http://hl7.org/fhir/appointmentstatus
                          code:
                            description: The booking status itself including any pending action.
                            type: string
                            enum:
                              - booked
                              - fulfilled
                              - cancelled
                              - noshow
                              - bookedPendingCancellation
                              - bookedPendingReschedule
                              - bookedPendingChange
                              - cancelledPendingReschedule
                  - description: The consultation medium for the booking (face-to-face or virtual). Always present if the activity is a booking, but might be blank if the underlying consultation type is not recognised.
                    type: object
                    required:
                      - url
                      - valueCode
                    properties:
                      url:
                        description: FHIR extension type for the consultation medium code.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
                      valueCode:
                        description: The consultation code medium itself. Will be blank (empty string) if the underlying consultation type is not recognised.
                        type: string
                        enum:
                          - FACE_TO_FACE
                          - VIRTUAL
                  - description: Encounter class element
                    type: object
                    required:
                      - url
                      - valueCode
                    properties:
                      url:
                        description: FHIR extension type for the encounter class code.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
                      valueCode:
                        description: The encounter class required itself.
                        type: string
                        enum:
                          - outpatient
                          - inpatient
                          - daycase
            description:
              description: Specialty name of the booking. _Note; this is freetext and can contain some data quality issues._
              type: string
              example: Dermatology
            scheduledPeriod:
              description: The period over which the activity is to occur.
              type: object
              required:
                - start
              properties:
                start:
                  description: The date and time at which the booking is scheduled to start.
                  type: string
                  example: '2024-06-02T13:15:00.000Z'
                end:
                  description: The date and time at which the booking is scheduled to end, if known. _Note; this is required when the EncounterClass is Inpatient or DayCase._
                  type: string
                  example: '2024-06-02T13:45:00.000Z'
            location:
              description: Booking location. Building name with a fallback of the provider (NHS Turst) ODS Organisation name. Building name not provided when the booking is virtual i.e. not at a physical location. _Note; This values was previously contained within the description_ 
              type: object
              properties:
                type:
                  description: Type of entity.
                  type: string
                  enum:
                    - Location
                display:
                  description: Plain text location of the entity.
                  type: string
                  example: St Stephen's Hospital
    Document:
      description: A summary of the document for the patient.
      type: object
      required:
        - detail
      properties:
        detail:
          description: Details of the document
          type: object
          required:
            - kind
            - status
            - description
            - scheduledPeriod
          properties:
            id:
              description: Identifier for the Document
              type: string
              example: c21417eb-ffef-4a9e-b367-ebd8b8c29e7e
            kind:
              description: Type of activity - document (`DocumentReference`).
              type: string
              enum:
                - DocumentReference
            status:
              description: The status of the Document
              type: string
              enum:
                - in-progress
            extension:
              description: FHIR extension wrapper for various country-specific data items.
              type: array
              items:
                anyOf:
                  - description: URL for a patient-facing web application for the referral or booking. Always present.
                    type: object
                    required:
                      - url
                      - valueUrl
                      - extension
                    properties:
                      url:
                        description: FHIR extension type.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
                      valueUrl:
                        description: The URL itself.
                        type: string
                        example: https://refer.nhs.uk/nhslogin?ubrn=808993698030
                  - description: FHIR extension wrapper for the details of which upstream application the referral or booking came from.
                    type: array
                    items:
                      description: Unique identifier for the upstream application the referral or booking came from.
                      type: object
                      required:
                        - url
                        - valueCode
                      properties:
                        url:
                          description: FHIR extension type for the identifier.
                          type: string
                          enum:
                            - client-id
                        valueCode:
                          description: The identifier itself.
                          type: string
                          example: ers-01
                  - description: Reference to Appointment extension
                    type: object
                    required:
                      - url
                      - valueReference
                    properties:
                      url:
                        description: FHIR extension uri for the Appointment Reference.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
                      valueReference:
                        description: The Reference to Appointment which this Document is associated to.
                        type: object
                        required:
                          - reference
                        properties:
                          reference:
                            type: string
                            example: Appointment/caa99978-05ab-4473-8280-e77ebfe797c4
                  - description: Read receipt extension
                    type: object
                    required:
                      - url
                      - valueCode
                    properties:
                      url:
                        description: FHIR extension type for the read receipt code.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
                      valueCode:
                        description: The read receipt itself, if the document has been viewed by the patient or not.
                        type: string
                        enum:
                          - read
                          - unread
                          - seen
            description:
              description: Description of the Document to be displayed to the patient. _Note; this is freetext and can contain some data quality issues._
              type: string
              example: Dermatology follow-up letter
            scheduledPeriod:
              description: The period over which the activity is to occur.
              type: object
              required:
                - start
              properties:
                start:
                  description: The effective date of the Document i.e. the date the document was created/first available to the patient. This should match the date contained within the document.
                  type: string
                  example: '2022-06-02T09:25:13.000Z'
    Questionnaire:
      description: A summary of the questionnaire for the patient.
      type: object
      required:
        - detail
      properties:
        detail:
          description: Details of the referral or booking.
          type: object
          required:
            - kind
            - status
            - description
          properties:
            id:
              description: Identifier for the QuestionnaireResponse
              type: string
              example: c21417eb-ffef-4a9e-b367-ebd8b8c29e7c
            kind:
              description: Type of activity - questionnaire (`QuestionnaireResponse`).
              type: string
              enum:
                - QuestionnaireResponse
            status:
              description: The status of the questionnaire, if it has been started or completed by the patient.
              type: string
              enum:
                - not-started
                - in-progress
                - completed
                - cancelled
            extension:
              description: FHIR extension wrapper for various country-specific data items.
              type: array
              items:
                anyOf:
                  - description: URL for a patient-facing web application for the referral or booking. Always present.
                    type: object
                    required:
                      - url
                      - valueUrl
                      - extension
                    properties:
                      url:
                        description: FHIR extension type.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
                      valueUrl:
                        description: The URL itself.
                        type: string
                        example: https://refer.nhs.uk/nhslogin?ubrn=808993698030
                  - description: FHIR extension wrapper for the details of which upstream application the referral or booking came from.
                    type: array
                    items:
                      description: Unique identifier for the upstream application the referral or booking came from.
                      type: object
                      required:
                        - url
                        - valueCode
                      properties:
                        url:
                          description: FHIR extension type for the identifier.
                          type: string
                          enum:
                            - client-id
                        valueCode:
                          description: The identifier itself.
                          type: string
                          example: ers-01
                  - description: Reference to Appointment extension
                    type: object
                    required:
                      - url
                      - valueReference
                    properties:
                      url:
                        description: FHIR extension uri for the Appointment Reference.
                        type: string
                        enum:
                          - https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
                      valueReference:
                        description: The Reference to Appointment which this Questionnaire is associated to.
                        type: object
                        required:
                          - reference
                        properties:
                          reference:
                            type: string
                            example: Appointment/caa99978-05ab-4473-8280-e77ebfe797c4
            description:
              description: Description of the questionnaire to be displayed to the patient. _Note; this is freetext and can contain some data quality issues._
              type: string
              example: Preassessment questionnaire
            scheduledPeriod:
              description: The period over which the activity is to occur.
              type: object
              required:
                - start
              properties:
                start:
                  description: The effective date of the questionnaire i.e. the date the questionnaire was first available to the patient to complete.
                  type: string
                  example: '2022-06-02T18:00:00.000Z'
    OperationOutcome:
      description: A FHIR `OperationOutcome` resource containing details of the issues that have occurred.
      type: object
      required:
        - resourceType
        - issue
      properties:
        resourceType:
          description: FHIR resource type.
          type: string
          minLength: 1
          enum:
            - OperationOutcome
        id:
          description: The X-Correlation-ID from the Request header
          type: string
          example:
            $ref: "#/components/parameters/xCorrelationId/schema/example"
        meta:
          description: Metadata about the resource
          type: object
          properties:
            profile:
              description: Profiles this resource claims to conform to
              type: array
              items:
                description: Wayfinder UK Core `OperationOutcome` `StructureDefinition`
                type: string
                enum:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          description: An array of issues that occurred in processing the request. Usually there is only one issue, but there can be more than one.
          type: array
          uniqueItems: true
          minItems: 1
          items:
            description: An issue that occurred.
            type: object
            required:
              - severity
              - code
            properties:
              severity:
                description: Severity of the issue.
                type: string
                minLength: 1
                enum:
                  - fatal
                  - error
                  - warning
                  - information
              code:
                description: |
                  Error code for the issue. See [http://hl7.org/fhir/issue-type](http://hl7.org/fhir/issue-type)
                  `timeout` means the request to the upstream application timed out;
                  `structure` means the response received from the upstream application failed validation;
                  `transient` or `exception` means we received an unexpected error from the upstream application;
                  `business-rule` means the response has qualified business logic to suppress or transform the data returned. 
                type: string
                minLength: 1
                enum:
                  - timeout
                  - structure
                  - transient
                  - exception
                  - business-rule
              extension:
                description: FHIR `Extension` for the details of which upstream application the `Issue` it relates.
                type: array
                items:
                  description: Details of which upstream API that the `Issue` relates.
                  type: object
                  required:
                    - url
                    - valueCode
                  properties:
                    url:
                      description: FHIR extension uri for the upstream API that the `Issue` relates.
                      type: string
                      enum:
                        - https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                    valueCode:
                      description: Identifier for the upstream API that returned the error.
                      type: string
                      example: myportal-02
              diagnostics:
                description: Detailed diagnostic information for the issue.
                type: string
                minLength: 1
                example: Response failed FHIR validation
      externalDocs:
        description: FHIR UK Core OperationOutcome (R4) Resource Profile
        url: https://hl7.org/fhir/R4/operationoutcome.html
  parameters:
    xRequestId:
      name: X-Request-ID
      in: header
      required: false
      description: |
        A globally unique identifier (GUID) for the request, which we use to de-duplicate repeated requests and to trace the request if you contact our helpdesk.

        Must be a universally unique identifier (UUID) (ideally version 4).

        Not mirrored back in a response header (we might change this).

        If you re-send a failed request, use the same value in this header.
      schema:
        type: string
        format: uuid
        example: 8b16ccfa-8e46-4ba5-bd04-ba9371c69db9
    xCorrelationId:
      name: X-Correlation-ID
      in: header
      required: true
      description: An identifier which is used to track transactions across multiple systems. It can take any value, but we recommend avoiding `.` characters.
      schema:
        type: string
        format: uuid
        example: c93e2449-a2ef-4476-ad15-13491036be22
    nhsNumber:
      name: patient:identifier
      in: query
      description: |
        The patient's NHS number.
        Expressed as `<type>|<value>` where `<type>` must be `https://fhir.nhs.uk/Id/nhs-number` and `<value>` must be a [valid NHS number](https://www.datadictionary.nhs.uk/attributes/nhs_number.html).
      required: true
      schema:
        type: string
        pattern: ^https:\/\/fhir\.nhs\.uk\/Id\/nhs-number\|[1-9][0-9]{9}$
        example: https://fhir.nhs.uk/Id/nhs-number|9000000009
    nhsdIdToken:
      name: NHSD-ID-Token
      in: header
      required: true
      description: Valid NHS login ID Token JWT issues from the corresponding enviroment, see Security and authorisation above.
      schema:
        type: string
        format: byte
        example: eyJzdWIiOiI4MmEyOTZkMC03NTJjLTRjZjEtOWEwMC03MzgwNmJiMWY4MzMiLCJhdWQiOiJuaHMtb25saW5lIiwia2lkIjoiZjYwZWI0NmZmOGFiZjBiZjllOTE3ZWVlNjA4NmM1ZmE0YTE2MmE1ZCIsImlzcyI6Imh0dHBzOi8vYXV0aC5hb3Muc2lnbmluLm5ocy51ayIsInR5cCI6IkpXVCIsImV4cCI6MTY1NzEwMTY4OCwiaWF0IjoxNjU3MDk4MDg4LCJhbGciOiJSUzUxMiIsImp0aSI6ImZjMzYyZGY0LWRlOWMtNDY1OS1hM2RmLWVmMDEwMDAwZjQ0MCJ9.eyJzdWIiOiI4MmEyOTZkMC03NTJjLTRjZjEtOWEwMC03MzgwNmJiMWY4MzMiLCJiaXJ0aGRhdGUiOiIxOTg1LTA5LTA3IiwibmhzX251bWJlciI6Ijk3MjY3NzkwNTciLCJpc3MiOiJodHRwczovL2F1dGguYW9zLnNpZ25pbi5uaHMudWsiLCJ2dG0iOiJodHRwczovL2F1dGguYW9zLnNpZ25pbi5uaHMudWsvdHJ1c3RtYXJrL2F1dGguYW9zLnNpZ25pbi5uaHMudWsiLCJhdWQiOiJuaHMtb25saW5lIiwiaWRfc3RhdHVzIjoidmVyaWZpZWQiLCJ0b2tlbl91c2UiOiJpZCIsInN1cm5hbWUiOiJDSE9OIiwiYXV0aF90aW1lIjoxNjU3MDk4MDgxLCJ2b3QiOiJQOS5DcC5DZCIsImlkZW50aXR5X3Byb29maW5nX2xldmVsIjoiUDkiLCJleHAiOjE2NTcxMDE2ODgsImlhdCI6MTY1NzA5ODA4OCwiZmFtaWx5X25hbWUiOiJDSE9OIiwianRpIjoiZmMzNjJkZjQtZGU5Yy00NjU5LWEzZGYtZWYwMTAwMDBmNDQwIn0.fEar_s6EaRWj1oWW1Kb_ekYFH2zPOjH4GdixoXKxvc7H7BEAnBt3k9FUMVIg9UD5i-4iu7hUy5p_0BbFZL5mPFFAnW67lAZV2D8FOcHDNunDU64ov5nNsBubHGOotRpExgHBxCF31eHonzzE8g2A7j4mmZJxlJ0MX-qCuF3CRiAc1apI_2ugPEDTFkX53YBNtDg2kDUVDTthCDdg1ylOiHunCurCXMaJSPmOGsac_ltRgYM_fs64MXoLmSNXUvxWa18N4689vipQ9hG4VASQQvPYMkgiynv6oX8ME9RPbBdmlTceeuEXiwLrvXtrU4xZkU3Js1x9DNTkZ96Fg9-yOQ
    nhsdTargetIdentifier:
      name: NHSD-Target-Identifier
      in: header
      required: true
      description: |
        A unique identifier for this API, as required by the Booking and Referral Standard (BaRS). Specifically, it is a Base64 encoding of:

        `{ "system": "urn:ietf:rfc:3986", "value": "db71698b-cd7c-4dd5-95c4-0aa9776595f5" }`

        (where the GUID `db71698b-cd7c-4dd5-95c4-0aa9776595f5` is the unique identifier for this API)
      schema:
        type: string
        format: byte
        example: ewrCoCDCoCAic3lzdGVtIjogInVybjppZXRmOnJmYzozOTg2IiwKwqAgwqAgInZhbHVlIjogImRiNzE2OThiLWNkN2MtNGRkNS05NWM0LTBhYTk3NzY1OTVmNSIKfQ==
  securitySchemes:
    oAuth2ClientCredentials:
      type: "oauth2"
      description: "See https://digital.nhs.uk/developer/guides-and-documentation/security-and-authorisation#user-restricted-apis"
      flows:
        clientCredentials:
          tokenUrl: "https://int.api.service.nhs.uk/oauth2/token"
          scopes: {}
    ApimAccessToken:
      type: "http"
      description: An OAuth 2.0 bearer token, obtained using one of the security patterns explained in the 'Security and authorisation' section above.
      scheme: "bearer"
      bearerFormat: "JWT"
  responses:
    2XX:
      description: |
        The request was valid and the API was able to request information from the various upstream applications.
  
        There are two possible outcomes:
  
        | HTTP status | Description                                                         |
        | ----------- | ------------------------------------------------------------------- |
        | 200         | A successful request will return a HTTP status code of `200 OK` containing a FHIR `Bundle` with `0..*` `CarePlan` resources. All upstream systems responded normally. |
        | 207         | If an error occurs with an upstream service the aggregator will return a `207 Multi-status` containing a FHIR `Bundle` with `0..*` `CarePlan` resources and one `OperationOutcome` with each of the errors listed as issues. |
      headers:
        #X-Request-ID:
        #  $ref: "#/components/headers/xRequestId"
        X-Correlation-ID:
          $ref: "#/components/headers/xCorrelationId"
      content:
        application/fhir+json:
          schema:
            $ref: "#/components/schemas/Bundle"
          examples:
            # Full responses
            emptyBundle:
              $ref: "#/components/examples/emptyBundle"
            operationOutcomeBusinessRule:
              $ref: "#/components/examples/operationOutcomeBusinessRule"
            allReferralStates:
              $ref: "#/components/examples/allReferralStates"
            allAppointmentStates:
              $ref: "#/components/examples/allAppointmentStates"
            allDocumentStates:
              $ref: "#/components/examples/allDocumentStates"
            allQuestionnairestates:
              $ref: "#/components/examples/allQuestionnairestates"
            incompleteWaitingLists:
              $ref: "#/components/examples/incompleteWaitingLists"
            incompleteWaitingListBreastScreening: # Not current supported
              $ref: "#/components/examples/incompleteWaitingListBreastScreening"
            completeWaitingLists: # Not current supported
              $ref: "#/components/examples/completeWaitingLists"
            multipleWaitingLists:
              $ref: "#/components/examples/multipleWaitingLists"
            incompleteWaitingListUnattachedReferral:
              $ref: "#/components/examples/incompleteWaitingListUnattachedReferral"
            incompleteWaitingListUnattachedFutureAppointment:
              $ref: "#/components/examples/incompleteWaitingListUnattachedFutureAppointment"
            incompleteWaitingListUnattachedMultipleAppointments:
              $ref: "#/components/examples/incompleteWaitingListUnattachedMultipleAppointments"
            incompleteWaitingListUnattachedMultipleAppointmentsInpatients:
              $ref: "#/components/examples/incompleteWaitingListUnattachedMultipleAppointmentsInpatients"
            # Partial Error
            oneOrMoreErrors:
              $ref: "#/components/examples/oneOrMoreErrors"
            # Error handling
            upstreamTimeout:
              $ref: "#/components/examples/upstreamTimeout"
            upstreamFailedValidation:
              $ref: "#/components/examples/upstreamFailedValidation"
            upstreamHttpStatusError:
              $ref: "#/components/examples/upstreamHttpStatusError"
            upstreamUnexpected:
              $ref: "#/components/examples/upstreamUnexpected"
            upstreamMultipleErrors:
              $ref: "#/components/examples/upstreamMultipleErrors"
            # FRAGMENTS
            # Referrals
            referralActiveBookable:
              $ref: "#/components/examples/referralActiveBookable"
            referralActive2WW:
              $ref: "#/components/examples/referralActive2WW"
            referralActiveBookableWasCancelled:
              $ref: "#/components/examples/referralActiveBookableWasCancelled"
            referralActiveInReviewWithDueDate:
              $ref: "#/components/examples/referralActiveInReviewWithDueDate"
            referralActiveInReviewWithoutDueDate:
              $ref: "#/components/examples/referralActiveInReviewWithoutDueDate"
            #referralHistoric: # Not current supported
            #  $ref: "#/components/examples/referralHistoric"
            # Appointments
            appointmentFutureErsFaceToFace:
              $ref: "#/components/examples/appointmentFutureErsFaceToFace"
            appointmentFutureErsVirtual:
              $ref: "#/components/examples/appointmentFutureErsVirtual"
            appointmentFutureErs2WW:
              $ref: "#/components/examples/appointmentFutureErs2WW"
            appointmentFutureErsIndirectBooking:
              $ref: "#/components/examples/appointmentFutureErsIndirectBooking"
            appointmentFuturePepBooked:
              $ref: "#/components/examples/appointmentFuturePepBooked"
            appointmentHistoricPepAttended:
              $ref: "#/components/examples/appointmentHistoricPepAttended"
            appointmentHistoricPepCancelled:
              $ref: "#/components/examples/appointmentHistoricPepCancelled"
            appointmentFuturePepCancelled:
              $ref: "#/components/examples/appointmentFuturePepCancelled"
            appointmentHistoricPepDNA:
              $ref: "#/components/examples/appointmentHistoricPepDNA"
            appointmentFuturePepBookedPendingCancellation:
              $ref: "#/components/examples/appointmentFuturePepBookedPendingCancellation"
            appointmentFuturePepBookedPendingReschedule:
              $ref: "#/components/examples/appointmentFuturePepBookedPendingReschedule"
            appointmentFuturePepBookedPendingChange:
              $ref: "#/components/examples/appointmentFuturePepBookedPendingChange"
            appointmentHistoricPepCancelledPendingReschedule:
              $ref: "#/components/examples/appointmentHistoricPepCancelledPendingReschedule"
            appointmentFuturePepCancelledPendingReschedule:
              $ref: "#/components/examples/appointmentFuturePepCancelledPendingReschedule"
            appointmentFuturePepFaceToFace:
              $ref: "#/components/examples/appointmentFuturePepFaceToFace"
            appointmentFuturePepVirtual:
              $ref: "#/components/examples/appointmentFuturePepVirtual"
            appointmentHistoricPepFaceToFace:
              $ref: "#/components/examples/appointmentHistoricPepFaceToFace"
            appointmentHistoricPepVirtual:
              $ref: "#/components/examples/appointmentHistoricPepVirtual"
            appointmentHistoricSusAttended:
              $ref: "#/components/examples/appointmentHistoricSusAttended"
            appointmentHistoricSusCancelled:
              $ref: "#/components/examples/appointmentHistoricSusCancelled"
            appointmentHistoricSusDNA:
              $ref: "#/components/examples/appointmentHistoricSusDNA"
            # Diagnostics
            diagnosticFuturePepBooked:
              $ref: "#/components/examples/diagnosticFuturePepBooked"
            diagnosticHistoricPepAttended:
              $ref: "#/components/examples/diagnosticHistoricPepAttended"
            # Inpatients & Day cases
            inpatientFuturePepBooked:
              $ref: "#/components/examples/inpatientFuturePepBooked"
            inpatientFuturePepBookedPendingCancellation:
              $ref: "#/components/examples/inpatientFuturePepBookedPendingCancellation"
            inpatientFuturePepBookedPendingReschedule:
              $ref: "#/components/examples/inpatientFuturePepBookedPendingReschedule"
            inpatientFuturePepBookedPendingChange:
              $ref: "#/components/examples/inpatientFuturePepBookedPendingChange"
            inpatientFuturePepCancelled:
              $ref: "#/components/examples/inpatientFuturePepCancelled"
            inpatientFuturePepCancelledPendingReschedule:
              $ref: "#/components/examples/inpatientFuturePepCancelledPendingReschedule"
            daycaseFuturePepBooked:
              $ref: "#/components/examples/daycaseFuturePepBooked"
            daycaseFuturePepBookedPendingCancellation:
              $ref: "#/components/examples/daycaseFuturePepBookedPendingCancellation"
            daycaseFuturePepBookedPendingReschedule:
              $ref: "#/components/examples/daycaseFuturePepBookedPendingReschedule"
            daycaseFuturePepBookedPendingChange:
              $ref: "#/components/examples/daycaseFuturePepBookedPendingChange"
            daycaseFuturePepCancelled:
              $ref: "#/components/examples/daycaseFuturePepCancelled"
            daycaseFuturePepCancelledPendingReschedule:
              $ref: "#/components/examples/daycaseFuturePepCancelledPendingReschedule"
            inpatientHistoricPepAttended:
              $ref: "#/components/examples/inpatientHistoricPepAttended"
            inpatientHistoricPepCancelled:
              $ref: "#/components/examples/inpatientHistoricPepCancelled"
            inpatientHistoricPepCancelledPendingReschedule:
              $ref: "#/components/examples/inpatientHistoricPepCancelledPendingReschedule"
            daycaseHistoricPepAttended:
              $ref: "#/components/examples/daycaseHistoricPepAttended"
            daycaseHistoricPepCancelled:
              $ref: "#/components/examples/daycaseHistoricPepCancelled"
            daycaseHistoricPepCancelledPendingReschedule:
              $ref: "#/components/examples/daycaseHistoricPepCancelledPendingReschedule"
            # Documents
            correspondenceUnreadLinked:
              $ref: "#/components/examples/correspondenceUnreadLinked"
            correspondenceUnreadUnlinked:
              $ref: "#/components/examples/correspondenceUnreadUnlinked"
            correspondenceSeenLinked:
              $ref: "#/components/examples/correspondenceSeenLinked"
            correspondenceSeenUnlinked:
              $ref: "#/components/examples/correspondenceSeenUnlinked"
            correspondenceReadLinked:
              $ref: "#/components/examples/correspondenceReadLinked"
            correspondenceReadUnlinked:
              $ref: "#/components/examples/correspondenceReadUnlinked"
            #Attachment:
            #  $ref: "#/components/examples/Attachment"
            # Questionnaires
            questionnaireIncompleteLinked:
              $ref: "#/components/examples/questionnaireIncompleteLinked"
            questionnaireIncompleteUnlinked:
              $ref: "#/components/examples/questionnaireIncompleteUnlinked"
            questionnairePartiallyCompleteLinked:
              $ref: "#/components/examples/questionnairePartiallyCompleteLinked"
            questionnairePartiallyCompleteUnlinked:
              $ref: "#/components/examples/questionnairePartiallyCompleteUnlinked"
            questionnaireCompleteLinked:
              $ref: "#/components/examples/questionnaireCompleteLinked"
            questionnaireCompleteUnlinked:
              $ref: "#/components/examples/questionnaireCompleteUnlinked"
            # Waiting Lists
            pathwayActiveEstimatedWait:
              $ref: "#/components/examples/pathwayActiveEstimatedWait"
            pathwayActiveNoEstimatedWait:
              $ref: "#/components/examples/pathwayActiveNoEstimatedWait"
            pathwayActivePendingReferral:
              $ref: "#/components/examples/pathwayActivePendingReferral"
            pathwayActiveReferralUpcomingAppointment:
              $ref: "#/components/examples/pathwayActiveReferralUpcomingAppointment"
            pathwayActiveReferralAppointmentHistoricAttended:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentHistoricAttended"
            pathwayActiveReferralAppointmentHistoricCancelled:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentHistoricCancelled"
            pathwayActiveReferralAppointmentHistoricDNA:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentHistoricDNA"
            pathwayActiveReferralAppointmentUpcomingDiagnostic:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentUpcomingDiagnostic"
            pathwayActiveReferralAppointmentHistoricDiagnostic:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentHistoricDiagnostic"
            pathwayActiveReferralAppointmentDiagnosticUpcomingAdmission:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentDiagnosticUpcomingAdmission"
            pathwayActiveReferralAppointmentDiagnosticAdmissionPostTreatmentFollowUp:
              $ref: "#/components/examples/pathwayActiveReferralAppointmentDiagnosticAdmissionPostTreatmentFollowUp"
            pathwayComplete:
              $ref: "#/components/examples/pathwayComplete"
            pathwayCompleteReferralAppointmentDiagnosticHistoricAdmission:
              $ref: "#/components/examples/pathwayCompleteReferralAppointmentDiagnosticHistoricAdmission"
    4XX:
      description: |
        When the aggregator service is unable to serve a successful response a FHIR `OperationOutcome` resource is returned with the relevant HTTP status code defined as follows:
  
        | HTTP status | Error code          | Description                                                         |
        | ----------- | ------------------- | ------------------------------------------------------------------- |
        | 400         | `exception`         | Missing or invalid NHS number in request                            |
        | 401         | `processing`        | Missing or invalid OAuth 2.0 bearer token in request                |
        | 401         | `processing`        | NHS number in request doesn't match NHS number in NHS login account |
        | 403         | `forbidden`         | Patient is under 16 years of age                                    |
        | 404         | `not-found`         | Invalid value in `NHSD-Target-Identifier` header                    |
        | 429         | `TOO_MANY_REQUESTS` | You have exceeded your application's [rate limit](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#rate-limits). |
  
        For details see the `diagnostics` field.
      headers:
        #X-Request-ID:
        #  $ref: "#/components/headers/xRequestId"
        X-Correlation-ID:
          $ref: "#/components/headers/xCorrelationId"
      content:
        application/fhir+json:
          schema:
            $ref: "#/components/schemas/OperationOutcome"
          examples:
            missingNhsNumber:
              $ref: "#/components/examples/missingNhsNumber"
            invalidNhsNumber:
              $ref: "#/components/examples/invalidNhsNumber"
            invalidAuthToken:
              $ref: "#/components/examples/invalidAuthToken"
            #mismatchNhsNumber:
            #  $ref: "#/components/examples/mismatchNhsNumber"
            under16:
              $ref: "#/components/examples/under16"
            #missingNhsdTargetIdentifier:
            #  $ref: "#/components/examples/missingNhsdTargetIdentifier"
        application/json:
          examples:
            rateLimit:
              $ref: "#/components/examples/rateLimit"
    5XX:
      description: |
        A 5xx status code means the server has a problem. For more details on the most common 5xx status codes and their meanings see the [HTTP status codes](https://digital.nhs.uk/developer/guides-and-documentation/reference-guide#http-status-codes).
      headers:
        #X-Request-ID:
        #  $ref: "#/components/headers/xRequestId"
        X-Correlation-ID:
          $ref: "#/components/headers/xCorrelationId"
      content:
        application/fhir+json:
          schema:
            $ref: "#/components/schemas/OperationOutcome"
          examples:
            internalError:
              $ref: "#/components/examples/internalError"
  headers:
    xRequestId:
      schema:
        $ref: "#/components/parameters/xRequestId/schema"
      description: Request parameter value echoed back (when provided)
    xCorrelationId:
      schema:
        $ref: "#/components/parameters/xCorrelationId/schema"
      description: Request parameter value echoed back (when provided)
  examples:
    # Full Responses
    emptyBundle:
      summary: 200 Empty bundle / no activity
      description: |
        A response where all upstream systems responded normally (HTTP status 200). Contains no resources.
        ```
        Bundle
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 0
    operationOutcomeBusinessRule:
      summary: 200 OperationOutcome with a business-rule issue
      value: 
        resourceType: Bundle
        id: 324ece62-ab9a-484d-b882-f401fdd2a67d
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/324ece62-ab9a-484d-b882-f401fdd2a67d
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: information
                  code: business-rule
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: "AGGBR30: rejected DocumentReference b8f57bab-be42-4c2b-bc03-8473bda9b512 with date 2013-01-23T17:10:00+00:00 due to being over 8 years in the past"
                - severity: information
                  code: business-rule
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-02
                  diagnostics: "AGGBR30: rejected Appointment 79a77bb8-6ca3-4952-ae5d-bc9f9cf773a9 with date 2014-03-10T09:15:00+00:00 due to being over 8 years in the past"
    allReferralStates:
      summary: 200 All Referral states
      value:
        resourceType: Bundle
        id: 1a432271-9aeb-4d54-8a9e-ef476e014e5b
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/1a432271-9aeb-4d54-8a9e-ef476e014e5b
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/referralActiveBookable"
                #- $ref: "#/components/examples/correspondenceUnreadLinked" # Not current supported by eRS
                - $ref: "#/components/examples/referralActive2WW"
                - $ref: "#/components/examples/referralActiveBookableWasCancelled"
                - $ref: "#/components/examples/referralActiveInReviewWithDueDate"
                - $ref: "#/components/examples/referralActiveInReviewWithoutDueDate"
                #- $ref: "#/components/examples/referralHistoric" # Not current supported
    allAppointmentStates:
      summary: 200 All Appointment states
      value:
        resourceType: Bundle
        id: 9c760510-89c8-4bb6-888c-339f400a1630
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/9c760510-89c8-4bb6-888c-339f400a1630
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/appointmentFutureErsFaceToFace"
                #- $ref: "#/components/examples/correspondenceUnreadLinked" # Not current supported by eRS
                - $ref: "#/components/examples/appointmentFutureErsVirtual"
                - $ref: "#/components/examples/appointmentFutureErs2WW"
                - $ref: "#/components/examples/appointmentFuturePepBooked"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
                - $ref: "#/components/examples/appointmentHistoricPepAttended"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/appointmentHistoricPepCancelled"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/appointmentFuturePepCancelled"
                - $ref: "#/components/examples/appointmentHistoricPepDNA"
                - $ref: "#/components/examples/appointmentFuturePepBookedPendingCancellation"
                - $ref: "#/components/examples/appointmentFuturePepBookedPendingReschedule"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/appointmentFuturePepBookedPendingChange"
                - $ref: "#/components/examples/appointmentHistoricPepCancelledPendingReschedule"
                - $ref: "#/components/examples/appointmentFuturePepCancelledPendingReschedule"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/appointmentFuturePepFaceToFace"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/appointmentFuturePepVirtual"
                - $ref: "#/components/examples/appointmentHistoricPepFaceToFace"
                - $ref: "#/components/examples/appointmentHistoricPepVirtual"
                - $ref: "#/components/examples/appointmentHistoricSusAttended"
                - $ref: "#/components/examples/appointmentHistoricSusCancelled"
                - $ref: "#/components/examples/appointmentHistoricSusDNA"
                # - $ref: "#/components/examples/diagnosticFuturePepBooked"
                # - $ref: "#/components/examples/diagnosticHistoricPepAttended"
                - $ref: "#/components/examples/inpatientFuturePepBooked"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/inpatientFuturePepBookedPendingCancellation"
                - $ref: "#/components/examples/inpatientFuturePepBookedPendingReschedule"
                - $ref: "#/components/examples/inpatientFuturePepBookedPendingChange"
                - $ref: "#/components/examples/inpatientFuturePepCancelled"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
                - $ref: "#/components/examples/inpatientFuturePepCancelledPendingReschedule"
                - $ref: "#/components/examples/daycaseFuturePepBooked"
                - $ref: "#/components/examples/daycaseFuturePepBookedPendingCancellation"
                - $ref: "#/components/examples/daycaseFuturePepBookedPendingReschedule"
                - $ref: "#/components/examples/daycaseFuturePepBookedPendingChange"
                - $ref: "#/components/examples/daycaseFuturePepCancelled"
                - $ref: "#/components/examples/daycaseFuturePepCancelledPendingReschedule"
                - $ref: "#/components/examples/inpatientHistoricPepAttended"
                - $ref: "#/components/examples/inpatientHistoricPepCancelled"
                - $ref: "#/components/examples/inpatientHistoricPepCancelledPendingReschedule"
                - $ref: "#/components/examples/daycaseHistoricPepAttended"
                - $ref: "#/components/examples/correspondenceSeenLinked"
                - $ref: "#/components/examples/daycaseHistoricPepCancelled"
                - $ref: "#/components/examples/daycaseHistoricPepCancelledPendingReschedule"
    allDocumentStates:
      summary: 200 All Document states
      value:
        resourceType: Bundle
        id: 0818c7bf-bd3d-4e77-b22a-c52831ff432b
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/0818c7bf-bd3d-4e77-b22a-c52831ff432b
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/correspondenceUnreadLinked"
                - $ref: "#/components/examples/correspondenceUnreadUnlinked"
                - $ref: "#/components/examples/correspondenceSeenLinked"
                - $ref: "#/components/examples/correspondenceSeenUnlinked"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/correspondenceReadUnlinked"
                #- $ref: "#/components/examples/Attachment" # Not current supported
    allQuestionnairestates:
      summary: 200 All Questionnaire states
      value:
        resourceType: Bundle
        id: 25075c73-ec31-4219-a935-2e31a5543702
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/25075c73-ec31-4219-a935-2e31a5543702
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/questionnaireIncompleteLinked"
                - $ref: "#/components/examples/questionnaireIncompleteUnlinked"
                - $ref: "#/components/examples/questionnairePartiallyCompleteLinked"
                - $ref: "#/components/examples/questionnairePartiallyCompleteUnlinked"
                - $ref: "#/components/examples/questionnaireCompleteLinked"
                - $ref: "#/components/examples/questionnaireCompleteUnlinked"
    incompleteWaitingLists:
      summary: 200 One incomplete waiting list
      description: |
        A successful response containing a `CarePlan` resource with one incomplete (active) Waiting List and no activity.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - $ref: "#/components/examples/pathwayActiveEstimatedWait"
    incompleteWaitingListBreastScreening:
      summary: 200 One incomplete Breast Screening pathway
      description: |
        ```
        Bundle
        âââ CarePlan
        â   âââ Appointment
        â   âââ Document
        â   âââ Appointment
        ```
      value:
        resourceType: Bundle
        id: 65185740-cc6f-4b80-98af-4da9b744ddb6
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - $ref: "#/components/examples/pathwayActiveBreastScreening"
    completeWaitingLists:
      summary: 200 One completed waiting list
      description: |
        A successful response containing a `CarePlan` resource with one completed (historic) Waiting List and no activity.
        ```
        Bundle
        âââ CarePlan (Completed Waiting List)
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - $ref: "#/components/examples/pathwayComplete"
    multipleWaitingLists:
      summary: 200 Multiple waiting lists; one complete and one incomplete and one unlinked appointment
      description: |
        A successful response containing two `CarePlan` resources with one completed (historic) Waiting List one incomplete (active) Waiting List and no activity.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        âââ CarePlan (Complete Waiting List)
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 3
        entry:
          - $ref: "#/components/examples/pathwayActiveReferralAppointmentDiagnosticUpcomingAdmission"
          - $ref: "#/components/examples/pathwayCompleteReferralAppointmentDiagnosticHistoricAdmission"
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/c93e2449-a2ef-4476-ad15-13491036be22
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/appointmentHistoricPepCancelled"
    incompleteWaitingListUnattachedReferral:
      summary: 200 Incomplete waiting lists with one unlinked Referral
      description: |
        A successful response containing two `CarePlan` resources with one incomplete (active) Waiting List and an unattached Referral.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        âââ CarePlan (Unattached activity)
        ```
      value:
        resourceType: Bundle
        id: dad94def-c69e-4df1-92fb-d610a8783770
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 2
        entry:
          - $ref: "#/components/examples/pathwayActiveEstimatedWait"
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/dad94def-c69e-4df1-92fb-d610a8783770
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/referralActiveBookableWasCancelled"
    incompleteWaitingListUnattachedFutureAppointment:
      summary: 200 Incomplete waiting lists with one unlinked Appointment with correspondence
      description: |
        A successful response containing two `CarePlan` resources with one incomplete (active) Waiting List and an unattached future Appointment.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        âââ CarePlan (Unattached activity)
        ```
      value:
        resourceType: Bundle
        id: 2c74b71e-5f4f-4086-adc8-e547c816cc00
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 2
        entry:
          - $ref: "#/components/examples/pathwayActiveEstimatedWait"
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/2c74b71e-5f4f-4086-adc8-e547c816cc00
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/appointmentFuturePepFaceToFace"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
    incompleteWaitingListUnattachedMultipleAppointments:
      summary: 200 Incomplete waiting lists with one unlinked Appointment with correspondence and questionnaires
      description: |
        A successful response containing two `CarePlan` resources with one incomplete (active) Waiting List and unattached Appointments with linked correspondence and questionnaires.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        âââ CarePlan (Unattached activity)
        ```
      value:
        resourceType: Bundle
        id: 6cc9be8c-f9c7-4c73-b41a-73ce7436fe11
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 2
        entry:
          - $ref: "#/components/examples/pathwayActiveEstimatedWait"
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/6cc9be8c-f9c7-4c73-b41a-73ce7436fe11
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/appointmentHistoricPepDNA"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/correspondenceSeenLinked"
                - $ref: "#/components/examples/appointmentHistoricSusAttended"
                - $ref: "#/components/examples/correspondenceSeenLinked"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
                - $ref: "#/components/examples/questionnaireCompleteLinked"
                - $ref: "#/components/examples/appointmentFuturePepBookedPendingReschedule"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
    incompleteWaitingListUnattachedMultipleAppointmentsInpatients:
      summary: 200 Incomplete waiting lists with one unlinked Appointment with correspondence and questionnaires
      description: |
        A successful response containing two `CarePlan` resources with one incomplete (active) Waiting List and unattached Appointments with linked correspondence and questionnaires.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        âââ CarePlan (Unattached activity)
        ```
      value:
        resourceType: Bundle
        id: ea29a536-f674-4362-92a6-70bf6f200340
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 2
        entry:
          - $ref: "#/components/examples/pathwayActiveEstimatedWait"
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/ea29a536-f674-4362-92a6-70bf6f200340
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/appointmentHistoricPepDNA"
                - $ref: "#/components/examples/correspondenceReadLinked"
                - $ref: "#/components/examples/correspondenceSeenLinked"
                - $ref: "#/components/examples/appointmentHistoricSusAttended"
                - $ref: "#/components/examples/correspondenceSeenLinked"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
                - $ref: "#/components/examples/inpatientHistoricPepCancelled"
                - $ref: "#/components/examples/questionnaireCompleteLinked"
                - $ref: "#/components/examples/daycaseFuturePepBookedPendingReschedule"
                - $ref: "#/components/examples/correspondenceUnreadLinked"
    oneOrMoreErrors:
      summary: 207 One referral, one booking and one upstream system error
      description: |
        A response where one upstream system returned an error (HTTP status 207). Includes a `CarePlan` resource containing one referral and one booking, and an `OperationOutcome` resource containing one upstream system error.
        ```
        Bundle
        âââ CarePlan (Incomplete Waiting List)
        âââ CarePlan
        â   âââ Appointment
        â   âââ Document
        âââ OperationOutcome
            âââ issue - HTTP 404 from upstream PEP
            âââ issue - FHIR validation error
        ```
      value:
        resourceType: Bundle
        id: 2dda10de-2472-4f3f-ab13-480557d63d93
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 3
        entry:
          - $ref: "#/components/examples/pathwayActiveEstimatedWait"
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/CarePlan/2dda10de-2472-4f3f-ab13-480557d63d93
            search:
              mode: match
            resource:
              resourceType: CarePlan
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
              status: active
              intent: order
              subject:
                identifier:
                  system: https://fhir.nhs.uk/Id/nhs-number
                  value: '9000000009'
              activity:
                - $ref: "#/components/examples/appointmentFuturePepFaceToFace"
                - $ref: "#/components/examples/correspondenceUnreadLinked" 
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/2dda10de-2472-4f3f-ab13-480557d63d93
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: error
                  code: transient
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: http-404
                - severity: error
                  code: structure
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-02
                  diagnostics: Response failed FHIR validation
    # Partial errors (OperationOutcome)
    upstreamTimeout:
      summary: 207 Upstream timeout
      description: |
        The record service has indicated a record may exist within the upstream myportal-01 API however the PEP endpoint has failed to respond in time so has not been processed as part of the aggregator response.
        ```
        Bundle
        âââ OperationOutcome
            âââ issue
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/c93e2449-a2ef-4476-ad15-13491036be22
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: error
                  code: timeout
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: myportal-01 request timed out
    upstreamFailedValidation:
      summary: 207 Upstream failed Validation
      description: |
        The myportal-01 API endpoint has returned a response that has failed validation from the aggregator so has not been processed as part of the aggregator response. This could be FHIR validation or our own internal validation.
        If the upstream response contained multiple appointments and one of the appointments contained a validation error for example then the whole response would be suppressed and an OperationOutcome response included for that Portal provider.
        ```
        Bundle
        âââ OperationOutcome
            âââ issue
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/c93e2449-a2ef-4476-ad15-13491036be22
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
            meta:
              profile:
                - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: error
                  code: structure
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: Response failed validation
    upstreamHttpStatusError:
      summary: 207 Upstream HTTP Status error
      description: |
        The myportal-01 API endpoint has returned an unexpected HTTP Status code response (i.e. not 200). The providers' response has not been processed as part of the aggregator response.
        ```
        Bundle
        âââ OperationOutcome
            âââ issue
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/c93e2449-a2ef-4476-ad15-13491036be22
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: error
                  code: transient
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: http-404
    upstreamUnexpected:
      summary: 207 Upstream unexpected error/exception
      description: |
        An unexpected error occurred while querying myportal-01 (e.g. ers token exchange failed, upstream API is not reachable, etc.)
        ```
        Bundle
        âââ OperationOutcome
            âââ issue
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/c93e2449-a2ef-4476-ad15-13491036be22
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: error
                  code: exception
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: Error querying myportal-01 endpoint
    upstreamMultipleErrors:
      summary: 207 Upstream multiple errors
      description: |
        Both the errors from examples 2 and 3 have occurred.
        The myportal-01 API endpoint has returned an unexpected HTTP Status code response (i.e. not 200). The providers' response has not been processed as part of the aggregator response.
        The pep-02 API endpoint has returned a response that has failed validation from the aggregator so has not been processed as part of the aggregator response.
        ```
        Bundle
        âââ OperationOutcome
            âââ issue - HTTP 404 from upstream PEP
            âââ issue - FHIR validation error
        ```
      value:
        resourceType: Bundle
        id: c93e2449-a2ef-4476-ad15-13491036be22
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreBundle
        type: searchset
        total: 1
        entry:
          - fullUrl: https://api.service.nhs.uk/patient-care-aggregator-api/OperationOutcome/c93e2449-a2ef-4476-ad15-13491036be22
            search:
              mode: include
            resource:
              resourceType: OperationOutcome
              meta:
                profile:
                  - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
              issue:
                - severity: error
                  code: exception
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: myportal-01
                  diagnostics: http-404
                - severity: error
                  code: exception
                  extension:
                    - url: https://fhir.nhs.uk/StructureDefinition/ExtensionErrorSource
                      valueCode: pep-02
                  diagnostics: Response failed FHIR validation
    # Error responses (OperationOutcome)
    missingNhsNumber:
      summary: 400 Missing patient:identifier search parameter
      description: No patient:identifier as a search parameter.
      value:
        resourceType: OperationOutcome
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          - severity: error
            code: exception
            diagnostics: '"patient:identifier" is required'
    invalidNhsNumber:
      summary: 400 Invalid patient:identifier search parameter
      description: "The patient:identifier is required to match the following regex pattern: /^https://fhir.nhs.uk/Id/nhs-number|[0-9]*$/"
      value:
        resourceType: OperationOutcome
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          - severity: error
            code: exception
            diagnostics: '"patient:identifier" with value "https://fhir.nhs.uk/Id/nhs-number" fails to match the required pattern: /^https://fhir.nhs.uk/Id/nhs-number|[0-9]*$/'
    mismatchNhsNumber:
      summary: 401 NHS number in request doesn't match NHS number in NHS login token
      value: 
        resourceType: OperationOutcome
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          - severity: error
            code: exception
            diagnostics: '"patient:identifier" with value "https://fhir.nhs.uk/Id/nhs-number|{NHS-Number}" fails to match the required NHS login token subject {NHS-Number}'
    invalidAuthToken:
      summary: 401 Missing or invalid OAuth 2.0 bearer token in request
      description: We do not explicitly serve this request but you may expect to receive this from APIM following a failed authentication process.
      value:
        resourceType: OperationOutcome
        issue:
          - severity: error
            code: forbidden
            details:
              coding:
                - system: https://fhir.nhs.uk/R4/CodeSystem/Spine-ErrorOrWarningCode
                  version: "1"
                  code: ACCESS_DENIED
                  display: Invalid access token
    under16:
      summary: 403 Patient is under 16 years of age
      description: The NHS Login token containing the patients birthdate is compared to the system date/time. When the patient is under 16 years old the following error is returned
      value:
        resourceType: OperationOutcome
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          - severity: error
            code: forbidden
            diagnostics: UNDER_16_DENIED
    missingNhsdTargetIdentifier:
      summary: 404 Invalid value in NHSD-Target-Identifier header
      description: |
        The NHSD-Target-Identifier request header should contain a base64 encoded identifier of the Target system plus a fixed value i.e.:
        ```json
        {
          "system": "urn:ietf:rfc:3986"
          "value": "db71698b-cd7c-4dd5-95c4-0aa9776595f5"
        }
        ```
        
        Which encodes to: `ewoKwqAgwqAgInN5c3RlbSI6ICJ1cm46aWV0ZjpyZmM6Mzk4NiIKCsKgIMKgICJ2YWx1ZSI6ICJkYjcxNjk4Yi1jZDdjLTRkZDUtOTVjNC0wYWE5Nzc2NTk1ZjUiCgp9`

        If the NHSD-Target-Identifier does not equal the above then a HTTP 404 error will be returned. The OperationOutcome returned will include an issue.
      value:
        resourceType: OperationOutcome
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          - severity: error
            code: not-found
            diagnostics: NOT_FOUND
    rateLimit:
      summary: 429 You have exceeded your application's rate limit.
      description: We do not explicitly serve this request but you may expect to receive this from APIM following rate limiting. This is not a FHIR response.
      value:
        message: "Your application, Patient Care Aggregator - INT, has exceeded its quota of 6000 requests every 1 minute(s) and is being rate limited."
        scope: "application"
        policy: "quota"
        limit: 6000
        interval: 1
        timeunit: "minute"
        ratelimiting_expiry_time_ms: 1716896160000
        message_id: "rrt-4746096881325101106-b-geu2-22287-470757-1"
    internalError:
      summary: 500 Internal Server Error
      description: For uncaught internal errors.
      value:
        resourceType: OperationOutcome
        meta:
          profile:
            - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreOperationOutcome
        issue:
          - severity: error
            code: exception
            diagnostics: An internal server error occurred
    # FRAGMENTS
    # Referrals
    referralActiveBookable:
      summary: Fragment - Active bookable referral
      value:
        detail:
          id: '808993698030'
          kind: ServiceRequest
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698030
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
              valueCoding:
                system: https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                code: bookable
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Specialty
              valueCoding:
                system: https://fhir.nhs.uk/STU3/CodeSystem/Specialty-1
                display: Ear, Nose & Throat
          description: ENT - Specialist Otology - Freeman - Newcastle FT - RTD
          scheduledPeriod:
            start: '2023-11-12T10:02:15.960Z'
          performer:
            - type: Organization
              display: THE NEWCASTLE UPON TYNE HOSPITALS NHS FOUNDATION TRUST
    referralActive2WW:
      summary: Fragment - Active bookable referral with suppressed specialty
      value:
        detail:
          id:  '808993698031'
          kind: ServiceRequest
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698031
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
              valueCoding:
                system: https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                code: bookable
          description: Urgent Suspected Cancer - Ophthalmology - Mid & South Essex NHS FT (Chelmsford)
          scheduledPeriod:
            start: '2023-08-22T12:15:36.492Z'
          performer:
            - type: Organization
              display: MID AND SOUTH ESSEX NHS FOUNDATION TRUST
    referralActiveBookableWasCancelled:
      summary: Fragment - Active bookable referral, previously cancelled
      value:
        detail:
          id: '808993698032'
          kind: ServiceRequest
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698032
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
              valueCoding:
                system: https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                code: bookableWasCancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Specialty
              valueCoding:
                system: https://fhir.nhs.uk/STU3/CodeSystem/Specialty-1
                display: Rheumatology
          description: Early Inflammatory Arthritis Service - Cheltenham General Hospital - RTE
          scheduledPeriod:
            start: '2024-02-14T08:45:23.932Z'
          performer:
            - type: Organization
              display: GLOUCESTERSHIRE HOSPITALS NHS FOUNDATION TRUST
    referralActiveInReviewWithDueDate:
      summary: Fragment - Active bookable referral in review with due date
      value:
        detail:
          id: '808993698033'
          kind: ServiceRequest
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698033
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
              valueCoding:
                system: https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                code: inReview
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Specialty
              valueCoding:
                system: https://fhir.nhs.uk/STU3/CodeSystem/Specialty-1
                display: Urology
          description: Urology - General Telephone Clinic - Clatterbridge Hospital RBL
          scheduledPeriod:
            start: '2024-06-21T14:23:59.592Z'
            extension:
              - url: http://fhir.nhs.net/StructureDefinition/Extension-eRS-ReviewDueDate
                valueDate: '2024-08-19'
          performer:
            - type: Organization
              display: WIRRAL UNIVERSITY TEACHING HOSPITAL NHS FOUNDATION TRUST
    referralActiveInReviewWithoutDueDate:
      summary: Fragment - Active bookable referral in review without due date
      value:
        detail:
          id: '808993698034'
          kind: ServiceRequest
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698034
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
              valueCoding:
                system: https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                code: inReview
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Specialty
              valueCoding:
                system: https://fhir.nhs.uk/STU3/CodeSystem/Specialty-1
                display: Neurology
          description: Neurology - University Hospitals Sussex - St Richard's Chichester - RYR
          scheduledPeriod:
            start: '2024-03-26T13:21:01.291Z'
          performer:
            - type: Organization
              display: UNIVERSITY HOSPITALS SUSSEX NHS FOUNDATION TRUST
    referralHistoric: # Not current supported
      summary: Fragment - Historic referral
      value:
        detail:
          id: '808993698001'
          kind: ServiceRequest
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-eRS-ServiceRequest-State
              valueCoding:
                system: https://fhir.nhs.uk/CodeSystem/eRS-ReferralState
                code: bookable
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Specialty
              valueCoding:
                system: https://fhir.nhs.uk/STU3/CodeSystem/Specialty-1
                display: Dermatology
          description: Dermatology General (WHH Ashford)-East Kent Hospitals Trust-RVV
          scheduledPeriod:
            start: '2023-05-10T10:02:15.233Z'
          performer:
            - type: Organization
              display: EAST KENT HOSPITALS UNIVERSITY NHS FOUNDATION TRUST
    # Appointments
    appointmentFutureErsFaceToFace:
      summary: Fragment - Future booked Appointment from eReferral Service (eRS), face to face
      value:
        detail:
          id: 31e4d6a2-5e83-4c45-9888-a7b9d4e82363
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698039
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Nephrology
          scheduledPeriod:
            start: '2027-01-02T10:30:00.000Z'
          location:
            type: Location
            display: "Chapel Allerton Hospital, Dentistry Dept, 2nd Floor"
    appointmentFutureErsVirtual:
      summary: Fragment - Future booked Appointment from eReferral Service (eRS), virtual
      value:
        detail:
          id: a5b56e3d-6218-4e98-b5c5-0cde49b6a002
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698045
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: VIRTUAL
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Cardiology Service
          scheduledPeriod:
            start: '2027-06-15T14:25:00.000Z'
          location:
            type: Location
            display: "Birmingham City Hospital"
    appointmentFutureErs2WW:
      summary: Fragment - Future booked Appointment from eReferral Service (eRS) with suppressed specialty
      value:
        detail:
          id: 9bce9b90-dc5c-41a0-bc3d-f829a4d8740e
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698064
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Gastroenterology
          scheduledPeriod:
            start: '2026-11-20T08:15:00.000Z'
          location:
            type: Location
            display: "Florence Portal House, Winchester Hospital"
    appointmentFutureErsIndirectBooking:
      summary: Fragment - Indirectly bookable Appointment from eReferral Service (eRS)
      value:
        detail:
          id: 68f134d3-f4cf-488a-a6ee-5109d8ef99ff
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://refer.nhs.uk/nhslogin?ubrn=808993698039
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: ers-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: GI and Liver (Medicine and Surgery)
          location:
            type: Location
            display: "General Hepatology A&G Service-University Hospitals Sussex-E0A3H"
    appointmentFuturePepBooked:
      summary: Fragment - Future booked Appointment from a PEP
      value:
        detail:
          id: 4a3836f5-2d42-4d3e-87c1-680173b7fa5c
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Dermatology
          scheduledPeriod:
            start: '2026-04-10T09:05:00.000Z'
          location:
            type: Location
            display: "Wye Valley NHS Trust"
    appointmentHistoricPepAttended:
      summary: Fragment - Historic attended Appointment from a PEP
      value:
        detail:
          id: 8d28f9e4-2e92-45b7-b9c8-3f7a498b6883
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/8d28f9e4-2e92-45b7-b9c8-3f7a498b6883
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Oral Maxillo-Facial Surgery
          scheduledPeriod:
            start: '2022-09-11T11:55:00.000Z'
          location:
            type: Location
            display: "Grantham Hospital Outpatients"
    appointmentHistoricPepCancelled:
      summary: Fragment - Historic cancelled Appointment from a PEP
      value:
        detail:
          id: d04a7608-1ae6-4b85-b43f-8e47c17af2c6
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/d04a7608-1ae6-4b85-b43f-8e47c17af2c6
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2021-04-25T10:40:00.000Z'
          location:
            type: Location
            display: "Queen Elizabeth Queen Mother Hospital"
    appointmentFuturePepCancelled:
      summary: Fragment - Future cancelled Appointment from a PEP
      value:
        detail:
          id: 6f21f372-416c-49a5-9130-cd58ad3c49b4
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/6f21f372-416c-49a5-9130-cd58ad3c49b4
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Rheumatology Service
          scheduledPeriod:
            start: '2026-10-30T15:15:00.000Z'
          location:
            type: Location
            display: "Basingstoke and North Hampshire Hospital"
    appointmentHistoricPepDNA:
      summary: Fragment - Historic no show (DNA) Appointment from a PEP
      value:
        detail:
          id: 8a642c95-5b4f-44db-8f41-75e1b1f3494a
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/8a642c95-5b4f-44db-8f41-75e1b1f3494a
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: noshow
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Audiology
          scheduledPeriod:
            start: '2020-12-05T09:45:00.000Z'
          location:
            type: Location
            display: "The Cove Macmillan Support Centre, Royal Cornwall Hospital"
    appointmentFuturePepBookedPendingCancellation:
      summary: Fragment - Future booked Appointment from a PEP, pending a cancellation
      value:
        detail:
          id: 49a84a85-6e3c-4321-8980-95e2c58b839d
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/49a84a85-6e3c-4321-8980-95e2c58b839d
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingCancellation
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: VIRTUAL
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Gastroenterology
          scheduledPeriod:
            start: '2026-07-25T08:55:00.000Z'
          location:
            type: Location
            display: "Chesterfield Royal Hospital"
    appointmentFuturePepBookedPendingReschedule:
      summary: Fragment - Future booked Appointment from a PEP, pending a reschedule
      value:
        detail:
          id: f342ec16-7df4-4cd4-b7e4-8813f9f91d7c
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/f342ec16-7df4-4cd4-b7e4-8813f9f91d7c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Nephrology
          scheduledPeriod:
            start: '2027-03-05T13:10:00.000Z'
          location:
            type: Location
            display: "Rheumatology Unit, Winchester Hospital"
    appointmentFuturePepBookedPendingChange:
      summary: Fragment - Future booked Appointment from a PEP, pending a change
      value:
        detail:
          id: 0dd61c63-96cf-4cfc-9c8d-659b8d5f5dd9
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/0dd61c63-96cf-4cfc-9c8d-659b8d5f5dd9
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingChange
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Rheumatology Service
          scheduledPeriod:
            start: '2026-11-18T14:00:00.000Z'
          location:
            type: Location
            display: "Florence Portal House, Winchester Hospital"
    appointmentHistoricPepCancelledPendingReschedule:
      summary: Fragment - Historic cancelled Appointment from a PEP, pending a reschedule
      value:
        detail:
          id: eb0ecf85-f28b-41c0-80c1-1f6b508b3c37
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/eb0ecf85-f28b-41c0-80c1-1f6b508b3c37
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelledPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: VIRTUAL
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Cardiology Service
          scheduledPeriod:
            start: '2020-10-07T08:20:00.000Z'
          location:
            type: Location
            display: "Queen Elizabeth Queen Mother Hospital"
    appointmentFuturePepCancelledPendingReschedule:
      summary: Fragment - Future cancelled Appointment from a PEP, pending a reschedule
      value:
        detail:
          id: 1dd9fc14-b3b2-4b0c-a55c-98e26a1a643a
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/1dd9fc14-b3b2-4b0c-a55c-98e26a1a643a
              extension:
                - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
                  valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelledPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2026-05-23T11:00:00.000Z'
          location:
            type: Location
            display: "Chesterfield Royal Hospital"
    appointmentFuturePepFaceToFace:
      summary: Fragment - Future booked Appointment from a PEP, face to face
      value:
        detail:
          id: 9d3ab156-621e-4d3e-b782-fbfa4536f1ed
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/9d3ab156-621e-4d3e-b782-fbfa4536f1ed
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Gastroenterology
          scheduledPeriod:
            start: '2026-08-14T13:45:00.000Z'
          location:
            type: Location
            display: "The Queen Elizabeth Hospital"
    appointmentFuturePepVirtual:
      summary: Fragment - Future booked Appointment from a PEP, virtual
      value:
        detail:
          id: 2c48ec66-2e84-407a-b9a1-6c42c4e8969a
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/2c48ec66-2e84-407a-b9a1-6c42c4e8969a
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: VIRTUAL
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Oral Maxillo-Facial Surgery
          scheduledPeriod:
            start: '2027-12-22T09:30:00.000Z'
          location:
            type: Location
            display: "Spinal Outpatients, Duke of Cornwall Spinal Treatment Centre, Salisbury District Hospital"
    appointmentHistoricPepFaceToFace:
      summary: Fragment - Historic attended Appointment from a PEP, face to face
      value:
        detail:
          id: b3c5b6d2-6c2f-4e88-9b9c-91c3d45cdd0c
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/b3c5b6d2-6c2f-4e88-9b9c-91c3d45cdd0c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Rheumatology Service
          scheduledPeriod:
            start: '2021-07-18T14:15:00.000Z'
          location:
            type: Location
            display: "St James Hospital, Chancellors Wing"
    appointmentHistoricPepVirtual:
      summary: Fragment - Historic attended Appointment from a PEP, virtual
      value:
        detail:
          id: 9f30c28b-c2f6-4e88-bcec-0b2c17f80b87
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/9f30c28b-c2f6-4e88-bcec-0b2c17f80b87
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: VIRTUAL
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Dermatology
          scheduledPeriod:
            start: '2020-11-08T16:45:00.000Z'
          location:
            type: Location
            display: "Surgical Outpatients, E Level, West Wing, Southampton General Hospital"
    appointmentHistoricSusAttended:
      summary: Fragment - Historic attended Appointment from SUS
      value:
        detail:
          id: e9b78c27-5d3f-4b68-8b94-c50de7a5d00a
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Cardiology Service
          scheduledPeriod:
            start: '2021-03-03T10:25:00.000Z'
          location:
            type: Location
            display: "Wye Valley NHS Trust"
    appointmentHistoricSusCancelled:
      summary: Fragment - Historic cancelled Appointment from SUS
      value:
        detail:
          id: 53b78dc9-1c3e-4a89-a84d-b76fd9e763c2
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: VIRTUAL
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Gastroenterology
          scheduledPeriod:
            start: '2022-06-17T09:55:00.000Z'
          location:
            type: Location
            display: "The Cove Macmillan Support Centre, Royal Cornwall Hospital"
    appointmentHistoricSusDNA:
      summary: Fragment - Historic no show (DNA) Appointment from SUS
      value:
        detail:
          id: fd7c59b8-6e53-4a1d-8a14-e192cc9b3e6f
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: noshow
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2019-05-22T15:35:00.000Z'
          location:
            type: Location
            display: "Outpatient Department at Buxton Hospital"
    # Diagnostics
    diagnosticFuturePepBooked:
      summary: Fragment - Future booked Diagnostic Appointment from a PEP
      value:
        detail:
          id: c692501c-1493-465b-a9c8-21f89c839a6f
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/c692501c-1493-465b-a9c8-21f89c839a6f
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: MRI Scan
          scheduledPeriod:
            start: '2026-02-02T09:30:00.000Z'
          location:
            type: Location
            display: "Chesterfield Royal Hospital"
    diagnosticHistoricPepAttended:
      summary: Fragment - Historic attended Diagnostic Appointment from a PEP
      value:
        detail:
          id: 1207afb4-0d02-4865-a185-24ad4e19cf58
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/1207afb4-0d02-4865-a185-24ad4e19cf58
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Consultation-Medium
              valueCode: FACE_TO_FACE
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: outpatient
          description: X-Ray Scan
          scheduledPeriod:
            start: '2023-04-05T10:15:00.000Z'
          location:
            type: Location
            display: "The Queen Elizabeth Hospital"
    # Inpatients & Day cases
    inpatientFuturePepBooked:
      summary: Fragment - Future Inpatient admission, booked
      value:
        detail:
          id: ed7c7037-93d9-4c78-b1b8-0723cf1d9108
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/ed7c7037-93d9-4c78-b1b8-0723cf1d9108
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Dermatology
          scheduledPeriod:
            start: '2027-08-25T00:00:00.000Z'
            end: '2027-08-29T00:00:00.000Z'
          location:
            type: Location
            display: Spinal Outpatients, Duke of Cornwall Spinal Treatment Centre, Salisbury District Hospital
    inpatientFuturePepBookedPendingCancellation:
      summary: Fragment - Future Inpatient admission, booked pending cancellation
      value:
        detail:
          id: 1028bcbe-4aaf-4527-aef3-4caad133275a
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/1028bcbe-4aaf-4527-aef3-4caad133275a
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingCancellation
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Cardiology Service
          scheduledPeriod:
            start: '2027-02-02T00:00:00.000Z'
            end: '2027-02-12T00:00:00.000Z'
          location:
            type: Location
            display: Spinal Outpatients, Duke of Cornwall Spinal Treatment Centre, Salisbury District Hospital
    inpatientFuturePepBookedPendingReschedule:
      summary: Fragment - Future Inpatient admission, booked pending reschedule
      value:
        detail:
          id: 048edd23-74d7-49b9-969b-2ddee7aa2afc
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/048edd23-74d7-49b9-969b-2ddee7aa2afc
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Audiology
          scheduledPeriod:
            start: '2026-07-21T08:00:00.000Z'
            end: '2026-07-27T17:00:00.000Z'
          location:
            type: Location
            display: Florence Portal House, Winchester Hospital
    inpatientFuturePepBookedPendingChange:
      summary: Fragment - Future Inpatient admission, booked pending change
      value:
        detail:
          id: 2d92a1fc-242f-4f33-8841-5ef8963eda0f
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/2d92a1fc-242f-4f33-8841-5ef8963eda0f
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingChange
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Nephrology
          scheduledPeriod:
            start: '2026-12-03T09:00:00.000Z'
            end: '2026-12-17T16:00:00.000Z'
          location:
            type: Location
            display: Florence Portal House, Winchester Hospital
    inpatientFuturePepCancelled:
      summary: Fragment - Future Inpatient admission, cancelled
      value:
        detail:
          id: 8e1d20db-56b4-4b34-b619-ef50ab3e0dc6
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/8e1d20db-56b4-4b34-b619-ef50ab3e0dc6
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Audiology
          scheduledPeriod:
            start: '2027-11-02T00:00:00.000Z'
            end: '2027-11-04T00:00:00.000Z'
          location:
            type: Location
            display: St James Hospital, Chancellors Wing
    inpatientFuturePepCancelledPendingReschedule:
      summary: Fragment - Future Inpatient admission, cancelled pending reschedule
      value:
        detail:
          id: 25b58164-53dc-4771-aad5-1e3eda1ec4f7
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/25b58164-53dc-4771-aad5-1e3eda1ec4f7
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelledPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Cardiology Service
          scheduledPeriod:
            start: '2027-07-18T08:00:00.000Z'
            end: '2027-07-18T08:00:00.000Z'
          location:
            type: Location
            display: Florence Portal House, Winchester Hospital
    daycaseFuturePepBooked:
      summary: Fragment - Future Day Case attendance, booked
      value:
        detail:
          id: 574b0d80-9291-44e9-bfc9-243344cabbf6
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/574b0d80-9291-44e9-bfc9-243344cabbf6
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: booked
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2026-10-12T08:45:00.000Z'
            end: '2026-10-12T16:45:00.000Z'
          location:
            type: Location
            display: Grantham Hospital Outpatients
    daycaseFuturePepBookedPendingCancellation:
      summary: Fragment - Future Day Case attendance, booked pending cancellation
      value:
        detail:
          id: aebfc1e2-83f2-44b5-8b70-ad152cf2a874
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/aebfc1e2-83f2-44b5-8b70-ad152cf2a874
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingCancellation
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Gastroenterology
          scheduledPeriod:
            start: '2027-01-08T08:00:00.000Z'
            end: '2027-01-08T17:00:00.000Z'
          location:
            type: Location
            display: The Cove Macmillan Support Centre, Royal Cornwall Hospital
    daycaseFuturePepBookedPendingReschedule:
      summary: Fragment - Future Day Case attendance, booked pending reschedule
      value:
        detail:
          id: 7ba4c15d-b447-42cb-b4f2-0548fe099d18
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/7ba4c15d-b447-42cb-b4f2-0548fe099d18
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2026-10-29T08:00:00.000Z'
            end: '2026-10-29T08:00:00.000Z'
          location:
            type: Location
            display: Birmingham City Hospital
    daycaseFuturePepBookedPendingChange:
      summary: Fragment - Future Day Case attendance, booked pending change
      value:
        detail:
          id: 64224c95-7d38-4179-b01f-7fe536d1d392
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/64224c95-7d38-4179-b01f-7fe536d1d392
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: bookedPendingChange
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Oral Maxillo-Facial Surgery
          scheduledPeriod:
            start: '2027-04-30T09:00:00.000Z'
            end: '2027-04-30T17:00:00.000Z'
          location:
            type: Location
            display: Queen Elizabeth Queen Mother Hospital
    daycaseFuturePepCancelled:
      summary: Fragment - Future Day Case attendance, cancelled
      value:
        detail:
          id: 7bd1de34-d520-44b4-9235-9536656ea467
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/7bd1de34-d520-44b4-9235-9536656ea467
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Rheumatology Service
          scheduledPeriod:
            start: '2027-06-30T12:00:00.000Z'
            end: '2027-06-30T18:00:00.000Z'
          location:
            type: Location
            display: Chapel Allerton Hospital, Dentistry Dept, 2nd Floor
    daycaseFuturePepCancelledPendingReschedule:
      summary: Fragment - Future Day Case attendance, cancelled pending reschedule
      value:
        detail:
          id: 2468a796-c8bc-4252-948b-9985fa510953
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/2468a796-c8bc-4252-948b-9985fa510953
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelledPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Dermatology
          scheduledPeriod:
            start: '2026-09-11T08:30:00.000Z'
            end: '2026-09-11T17:30:00.000Z'
          location:
            type: Location
            display: Munro Unit, St. Richards Hospital
    inpatientHistoricPepAttended:
      summary: Fragment - Historic Inpatient admission, attended
      value:
        detail:
          id: aa952e75-0f06-495a-91b1-fd249f312a50
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/aa952e75-0f06-495a-91b1-fd249f312a50
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Rheumatology Service
          scheduledPeriod:
            start: '2019-11-04T00:00:00.000Z'
            end: '2019-11-07T00:00:00.000Z'
          location:
            type: Location
            display: St James Hospital, Chancellors Wing
    inpatientHistoricPepCancelled:
      summary: Fragment - Historic Inpatient admission, cancelled
      value:
        detail:
          id: 6728329b-a97c-4270-8ebb-da863818dee4
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/6728329b-a97c-4270-8ebb-da863818dee4
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2022-08-03T12:00:00.000Z'
            end: '2022-08-13T12:00:00.000Z'
          location:
            type: Location
            display: Spinal Outpatients, Duke of Cornwall Spinal Treatment Centre, Salisbury District Hospital
    inpatientHistoricPepCancelledPendingReschedule:
      summary: Fragment - Historic Inpatient admission, cancelled pending reschedule
      value:
        detail:
          id: a1677df9-0797-4c45-a294-790a7bdf59e2
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/a1677df9-0797-4c45-a294-790a7bdf59e2
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelledPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: inpatient
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2021-07-24T09:00:00.000Z'
            end: '2021-07-25T17:00:00.000Z'
          location:
            type: Location
            display: St James Hospital, Chancellors Wing
    daycaseHistoricPepAttended:
      summary: Fragment - Historic Day Case attendance, attended
      value:
        detail:
          id: 152531ad-bbd7-4f36-88fb-5248f13fac7c
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/152531ad-bbd7-4f36-88fb-5248f13fac7c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: fulfilled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2022-11-14T08:00:00.000Z'
            end: '2022-11-14T17:00:00.000Z'
          location:
            type: Location
            display: Darton Health Centre
    daycaseHistoricPepCancelled:
      summary: Fragment - Historic Day Case attendance, cancelled
      value:
        detail:
          id: 308fd56a-5022-4639-85be-0ef8331940bc
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/308fd56a-5022-4639-85be-0ef8331940bc
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelled
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Ear Nose and Throat
          scheduledPeriod:
            start: '2023-06-29T08:00:00.000Z'
            end: '2023-06-29T18:00:00.000Z'
          location:
            type: Location
            display: Munro Unit, St. Richards Hospital
    daycaseHistoricPepCancelledPendingReschedule:
      summary: Fragment - Historic Day Case attendance, cancelled pending reschedule
      value:
        detail:
          id: 2ef05b61-935a-4db4-beb4-517278ceb93b
          kind: Appointment
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Appointment/2ef05b61-935a-4db4-beb4-517278ceb93b
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Appointment-Status
              valueCoding:
                system: http://hl7.org/fhir/appointmentstatus
                code: cancelledPendingReschedule
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Encounter-Class
              valueCode: daycase
          description: Colorectal Surgery
          scheduledPeriod:
            start: '2021-07-27T08:00:00.000Z'
            end: '2021-07-27T18:00:00.000Z'
          location:
            type: Location
            display: Grantham Hospital Outpatients
    # Documents
    correspondenceUnreadLinked:
      summary: Fragment - Correspondence in an unread state linked to an appointment
      value:
        detail:
          id: 0601504f-4c23-485a-a7ea-68a864269d7b
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document?id=0601504f-4c23-485a-a7ea-68a864269d7b
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
              valueReference:
                reference: Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: unread
          description: Dermatology follow-up letter
          scheduledPeriod:
            start: '2024-01-03T11:22:18.293Z'
    correspondenceUnreadUnlinked:
      summary: Fragment - Correspondence in an unread state not linked to an appointment
      value:
        detail:
          id: e05393e2-f3c8-4dd9-b880-f24e33e26bf0
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document?id=e05393e2-f3c8-4dd9-b880-f24e33e26bf0
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: unread
          description: Ear, Nose & Throat Appointment letter
          scheduledPeriod:
            start: '2024-03-23T09:23:12.203Z'
    correspondenceSeenLinked:
      summary: Fragment - Correspondence in an seen state linked to an appointment
      value:
        detail:
          id: 89eacf53-dc76-4629-8790-ef7bd0a71da6
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document/89eacf53-dc76-4629-8790-ef7bd0a71da6
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
              valueReference:
                reference: Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: seen
          description: Rheumatology reschedule letter
          scheduledPeriod:
            start: '2023-12-12T00:00:00.000Z'
    correspondenceSeenUnlinked:
      summary: Fragment - Correspondence in an seen state not linked to an appointment
      value:
        detail:
          id: 742d7fbf-9833-4901-9413-458cb594a9b0
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document/742d7fbf-9833-4901-9413-458cb594a9b0
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: seen
          description: Ophthalmology cancellation letter
          scheduledPeriod:
            start: '2024-07-02T07:45:23.000Z'
    correspondenceReadLinked:
      summary: Fragment - Correspondence in an read state linked to an appointment
      value:
        detail:
          id: db55e1c2-e53f-4d12-85df-265b167b3d66
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document?id=db55e1c2-e53f-4d12-85df-265b167b3d66
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
              valueReference:
                reference: Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: read
          description: Urology booking letter
          scheduledPeriod:
            start: '2024-02-21T14:23:10.111Z'
    correspondenceReadUnlinked:
      summary: Fragment - Correspondence in an read state not linked to an appointment
      value:
        detail:
          id: a62d58f8-4226-4b97-b0d4-4f27c4f16aa5
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document?id=a62d58f8-4226-4b97-b0d4-4f27c4f16aa5
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: read
          description: Neurology discharge letter
          scheduledPeriod:
            start: '2024-04-09T09:23:32.230Z'
    attachment: # TODO
      summary: Fragment - Attachment in an unread state linked to an correspondence
      value:
        detail:
          id: 3fa6a671-3e1c-459d-b70d-d3ae4c434c7c
          kind: DocumentReference
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Document?id=3fa6a671-3e1c-459d-b70d-d3ae4c434c7c
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Read-Receipt
              valueCode: unread
          description: Parking and Map of the hospital
          scheduledPeriod:
            start: '2024-04-09T09:23:32.230Z'
    # Questionnaires
    questionnaireIncompleteLinked:
      summary: Fragment - Questionnaire in an incomplete state linked to an appointment
      value:
        detail:
          id: 13efedca-18fa-4217-9221-d22d881bd029
          kind: QuestionnaireResponse
          status: not-started
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Questionnaire?id=13efedca-18fa-4217-9221-d22d881bd029
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
              valueReference:
                reference: Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
          description: MSK health questionnaire
          scheduledPeriod:
            start: '2024-01-13T07:33:23.192Z'
    questionnaireIncompleteUnlinked:
      summary: Fragment - Questionnaire in an incomplete state not linked to an appointment
      value:
        detail:
          id: db72020f-d0d1-4290-a9df-18e755ce51a5
          kind: QuestionnaireResponse
          status: not-started
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Questionnaire/db72020f-d0d1-4290-a9df-18e755ce51a5
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
          description: Pre-consultation Survey
          scheduledPeriod:
            start: '2023-03-18T11:01:10.102Z'
    questionnairePartiallyCompleteLinked:
      summary: Fragment - Questionnaire in an partially completed state linked to an appointment
      value:
        detail:
          id: 36f83a61-3634-4abf-ae3a-88f1a08ea4e5
          kind: QuestionnaireResponse
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Questionnaire?id=36f83a61-3634-4abf-ae3a-88f1a08ea4e5
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
              valueReference:
                reference: Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
          description: Pre-consultation Survey
          scheduledPeriod:
            start: '2023-12-01T23:01:23.120Z'
    questionnairePartiallyCompleteUnlinked:
      summary: Fragment - Questionnaire in an partially complated state not linked to an appointment
      value:
        detail:
          id: e4db2c48-3830-4fd1-8f83-84ec0936cc7b
          kind: QuestionnaireResponse
          status: in-progress
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Questionnaire/e4db2c48-3830-4fd1-8f83-84ec0936cc7b
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
          description: Ophthalmology waiting list validation
          scheduledPeriod:
            start: '2024-06-14T16:20:20.201Z'
    questionnaireCompleteLinked:
      summary: Fragment - Questionnaire in an completed state linked to an appointment
      value:
        detail:
          id: b519a5f2-dc78-417c-a5aa-1d62d889787b
          kind: QuestionnaireResponse
          status: completed
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Questionnaire?id=b519a5f2-dc78-417c-a5aa-1d62d889787b
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Linked-Resource
              valueReference:
                reference: Appointment/4a3836f5-2d42-4d3e-87c1-680173b7fa5c
          description: Asthma questionnaire
          scheduledPeriod:
            start: '2023-10-01T09:23:12.029Z'
    questionnaireCompleteUnlinked:
      summary: Fragment - Questionnaire in an completed state not linked to an appointment
      value:
        detail:
          id: 30cda6e1-92c1-4be3-996e-a08c7fae8ce0
          kind: QuestionnaireResponse
          status: completed
          extension:
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Portal-Link
              valueUrl: https://my.portal.com/Questionnaire/30cda6e1-92c1-4be3-996e-a08c7fae8ce0
            - url: https://fhir.nhs.uk/StructureDefinition/Extension-Client-id
              valueCode: myportal-01
          description: General Surgery waiting list validation
          scheduledPeriod:
            start: '2020-05-22T04:33:12.002Z'
    # Waiting Lists
    pathwayActiveEstimatedWait:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
    pathwayActiveNoEstimatedWait:
      summary: Fragment - Active Waiting List (Pathway) without an estimated wait time
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/RAX~ABC220343220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RAX~ABC220343220X
          status: active
          intent: order
          title: Dermatology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2024-03-13"
          author:
            type: Organization
            display: Kingston Hospital NHS Foundation Trust
    pathwayActiveBreastScreening:
      summary: Fragment - Active Breast Screening Pathway with an estimated wait time and pending referral
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/BS~901230921384
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2024-06-25T10:17:32+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/screening-programme-unique-id
              value: 901230921384
          status: active
          intent: order
          title: Breast Screening
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2024-03-02"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/correspondenceReadUnlinked"
            - $ref: "#/components/examples/appointmentHistoricPepCancelled"
            - $ref: "#/components/examples/correspondenceReadLinked"
            - $ref: "#/components/examples/appointmentFuturePepBooked"
            - $ref: "#/components/examples/correspondenceUnreadLinked"
    pathwayActivePendingReferral:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time and pending referral
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralActiveBookable"
    pathwayActiveReferralUpcomingAppointment:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referral and upcoming appointment
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentFutureErsFaceToFace"
    pathwayActiveReferralAppointmentHistoricAttended:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referral and attended appointment
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepAttended"
    pathwayActiveReferralAppointmentHistoricCancelled:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referral and cancelled appointment with correspondence
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepCancelled"
            - $ref: "#/components/examples/correspondenceReadLinked"
    pathwayActiveReferralAppointmentHistoricDNA:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referral, Did not attend appointment and correspondence
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepDNA"
            - $ref: "#/components/examples/correspondenceReadLinked"
    pathwayActiveReferralAppointmentUpcomingDiagnostic:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referal, appointments with correspondence and upcoming diagnostic
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepDNA"
            - $ref: "#/components/examples/correspondenceReadLinked"
            - $ref: "#/components/examples/appointmentHistoricPepAttended"
            - $ref: "#/components/examples/correspondenceUnreadLinked"
            - $ref: "#/components/examples/diagnosticFuturePepBooked"
            - $ref: "#/components/examples/correspondenceReadLinked"
    pathwayActiveReferralAppointmentHistoricDiagnostic:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referal, appointments with correspondence and historic diagnostic
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepDNA"
            - $ref: "#/components/examples/correspondenceReadLinked"
            - $ref: "#/components/examples/appointmentHistoricPepAttended"
            - $ref: "#/components/examples/correspondenceUnreadLinked"
            - $ref: "#/components/examples/diagnosticHistoricPepAttended"
            - $ref: "#/components/examples/correspondenceReadLinked"
    pathwayActiveReferralAppointmentDiagnosticUpcomingAdmission:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referral, appointment with correspondence and upcoming admission
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepDNA"
            - $ref: "#/components/examples/correspondenceReadLinked"
            - $ref: "#/components/examples/appointmentHistoricPepAttended"
            - $ref: "#/components/examples/correspondenceUnreadLinked"
            - $ref: "#/components/examples/diagnosticHistoricPepAttended"
            - $ref: "#/components/examples/inpatientFuturePepBooked"
            - $ref: "#/components/examples/questionnaireCompleteUnlinked"
    pathwayActiveReferralAppointmentDiagnosticAdmissionPostTreatmentFollowUp:
      summary: Fragment - Active Waiting List (Pathway) with an estimated wait time, historic referral, appointments with correspondence, diagnostic, admission and post treatment follow up
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/R1F~ABC220939220X
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-25T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC220939220X
          status: active
          intent: order
          title: Ophthalmology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: "2022-06-22"
            extension:
              - url: https://fhir.nhs.uk/StructureDefinition/Extension-PlannedWaitTime
                valueDuration:
                  value: 22
                  unit: "weeks"
          author:
            type: Organization
            display: Isle of Wight NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepDNA"
            - $ref: "#/components/examples/correspondenceReadLinked"
            - $ref: "#/components/examples/appointmentHistoricPepAttended"
            - $ref: "#/components/examples/correspondenceUnreadLinked"
            - $ref: "#/components/examples/diagnosticHistoricPepAttended"
            - $ref: "#/components/examples/inpatientHistoricPepAttended"
            - $ref: "#/components/examples/questionnaireCompleteUnlinked"
    pathwayComplete:
      summary: Fragment - Complete Waiting List (Pathway) with an estimated wait time appointment
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/RHU~ABC293903434B
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-18T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC293903434B
          status: completed
          intent: order
          title: Urology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: 2023-01-15
            end: 2023-10-03
          author:
            type: Organization
            display: Portsmouth Hospitals University NHS Trust
    pathwayCompleteReferralAppointmentDiagnosticHistoricAdmission:
      summary: Fragment - Complete Waiting List (Pathway) with an estimated wait time, historic referral, appointments with correspondence, diagnostic, admission and post treatment follow up
      value:
        fullUrl: https://internal-qa.api.service.nhs.uk/patient-care-aggregator-api/CarePlan/RHU~ABC293903434B
        search:
          mode: match
        resource:
          resourceType: CarePlan
          meta:
            profile:
              - https://fhir.nhs.uk/StructureDefinition/WayfinderUKCoreCarePlan
            lastUpdated: 2023-06-18T00:00:00+00:00
          identifier:
            - system: https://fhir.nhs.uk/Id/care-pathway-id
              value: RTD~ABC293903434B
          status: completed
          intent: order
          title: Urology
          subject:
            identifier:
              system: https://fhir.nhs.uk/Id/nhs-number
              value: '9000000009'
          period:
            start: 2023-01-15
            end: 2023-10-03
          author:
            type: Organization
            display: Portsmouth Hospitals University NHS Trust
          activity:
            - $ref: "#/components/examples/referralHistoric"
            - $ref: "#/components/examples/appointmentHistoricPepDNA"
            - $ref: "#/components/examples/correspondenceReadLinked"
            - $ref: "#/components/examples/appointmentHistoricPepAttended"
            - $ref: "#/components/examples/correspondenceUnreadLinked"
            - $ref: "#/components/examples/diagnosticHistoricPepAttended"
            - $ref: "#/components/examples/inpatientHistoricPepAttended"
            - $ref: "#/components/examples/questionnaireCompleteUnlinked"
security:
  - ApimAccessToken: []
tags:
  - name: Patient Care Aggregator
    description: Wayfinder Patient Care Aggregator
    externalDocs:
      url: https://digital.nhs.uk/developer/api-catalogue/patient-care-aggregator-fhir
